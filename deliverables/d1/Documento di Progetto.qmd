---
title: | 
  ![](../../.common-media/logo-unitn-ardeeno-512.png){width=10cm}

  Ardeeno WebApp

subtitle: |
  T41-SE22

  D1-Documento di Progetto

  v0.2
author: [alessandro.manfucci@studenti.unitn.it, enrico.cescato@studenti.unitn.it ,m.sottocornola-1@studenti.unitn.it]
date: "05-10-2022"
lang: it
format:
  pdf:
    include-in-header:
      text: |
        \usepackage{graphicx}
        \usepackage{wrapfig}
    documentclass: article
    classoption: titlepage
    toc: true
    toc-title: Indice
    papersize: a4
    number-sections: true
    geometry:
    - top=1in
    - bottom=1in
    - right=1in
    - left=1in
---

\pagebreak

## Abstract {.unnumbered}
Questo documento descrive ad alto livello -- e in maniera non tecnica -- il sistema da realizzare. Vengono definiti gli obiettivi e -- in linguaggio naturale -- i requisiti funzionali e non funzionali. Infine, viene mostrato un *mock-up* dell'applicazione e vengono fatte le prime considerazioni su come il *back-end* del sistema dovrà interagire con i sistemi esterni.

## Obiettivi del progetto
Il progetto ha come obiettivo lo sviluppo di una *web app* che gestisca la vendita di impianti *Internet of Things* (IoT), la loro installazione, manutenzione, riparazione e dismissione. Inoltre, l'applicazione permetterà al cliente di visualizzare le misurazioni dei propri impianti e richiedere eventuali interventi di riparazione.  
L'impianto IoT considerato è costituto da un insieme omogeneo di sensori distribuibili geograficamente, in grado di valutare la qualità dell'aria attraverso la misurazione periodica di vari parametri.

Nel dettaglio:

1. Un utente anonimo potrà visualizzare le informazioni generali relative all'azienda, le recensioni dei clienti, i tipi di impianto disponibili e il loro costo. L'utente potrà inoltre registrarsi come cliente o autenticarsi. Un utente autenticato -- cliente o dipendente dell'azienda -- potrà visualizzare e modificare i propri dati personali.

2. Un cliente potrà compiere tutte le attività di visualizzazione consentite ad un utente anonimo; in aggiunta, potrà acquistare gli impianti resi disponibili dall'azienda, visualizzare quelli già in suo possesso -- attivi o dismessi -- e accedere alle misurazioni effettuate dai sensori. Avrà la possibilità di visualizzare lo stato di tutti gli interventi effettuati sui propri impianti e richiedere un intervento di riparazione per quelli ancora attivi. Inoltre, potrà recensire l'azienda.

3. Il sistema dovrà gestire gli interventi di cui l'impianto necessita:
    - installazione, all'acquisto dell'impianto;
    - manutenzione, annuale e solo se l'impianto è attivo;
    - riparazione, su richiesta del cliente;
    - dismissione, dopo cinque anni dall'acquisto dell'impianto.  

  Ad ogni intervento è associato uno tra i seguenti stati: richiesto, assegnato in corso e assegnato concluso; ogni stato (ad eccezione di assegnato concluso) può evolvere nel tempo.  
  Le informazioni relative a tutti gli interventi potranno essere visualizzate da un supervisore, il quale potrà assegnare un tecnico e decidere la data dell'intervento (se in stato richiesto).

4. Un tecnico potrà visualizzare gli interventi a lui assegnati -- in corso o conclusi -- con i relativi dati del cliente e dell'impianto. Per ogni intervento assegnato in corso (la dismissione dell'impianto fa eccezione), avrà la possibilità di rimuovere ed/o aggiungere dei sensori, distinguibili tramite codice a barre e coordinate geografiche; ogni sensore può essere in stato attivo o dismesso. Un tecnico potrà inoltre inserire un resoconto e segnare l'intervento come concluso.  

5. Un amministratore potrà compiere tutte le azioni permesse ad un supervisore; inoltre, potrà visualizzare le statistiche sugli impianti venduti e su tutti gli interventi. Potrà registrare nuovi dipendenti e nominare supervisori.

\pagebreak

## Requisiti funzionali
Questo capitolo presenta i requisiti funzionali del sistema, raggruppati per ruolo.  
Si noti che un utente autenticato può essere cliente o dipendente dell'azienda (inteso come tecnico, supervisore o amministratore) e può compiere tutte le attività permesse ad un utente anonimo. Inoltre, le azioni consentite ad un supervisore possono essere eseguite anche da un amministratore.

<!--
Il sistema deve consentire [ad XXX] di XXX attraverso un form [- raggiungibile da []() -] nel quale sono presenti i campi:

Il sistema - tramite la pagina mostrata da []() - deve permettere

Il sistema - attraverso la selezione effettuata in []() - deve (permettere|far visualizzare)

Il sistema - - deve far visualizzare una lista di XXX dove per ogni XXX si mostra: YYY, ZZZ; ed eventualmente KKK. Il sistema deve permettere di selezionare un XXX dalla lista. La lista deve avere ordine cronologico da data richiesta più recente a meno recente.

deve far visualizzare tutti i dati già mostrati in []() ed inoltre

- tramite la pagina mostrata da []() - 
- attraverso la selezione effettuata in []() -
- raggiungibile da []() -
-->

### Utente anonimo

#### RF1 Visualizzazione presentazione {.unnumbered}
Il sistema deve mostrare una pagina di presentazione, che comprende una breve descrizione dell'azienda, una mappa che indica la posizione della sede, e i propri contatti (email e contatto telefonico).

#### RF2 Visualizzazione vetrina {.unnumbered}
Il sistema deve far visualizzare una lista dei tipi di impianto in vendita, dove per ognuno dei quali viene mostrato: nome del tipo, prezzo, immagine esemplificativa, superficie consigliata per quel specifico tipo di impianto (in $m^2$) e lista dei parametri misurati. Tra gli impianti visualizzati, il sistema deve permettere di selezionarne uno.

#### RF3 Visualizzazione recensioni {.unnumbered}
Il sistema deve mostrare una lista delle dieci più recenti recensioni con almeno tre stelle di gradimento. Ogni recensione deve comprendere: nome dell'autore, valutazione in stelle (da una a cinque), titolo e descrizione. Inoltre, il sistema deve far visualizzare il *TrustScore* dell'azienda, fornito dal servizio TrustPilot.

#### RF4 Registrazione cliente {.unnumbered}
Il sistema deve consentire ad un utente anonimo di registrarsi come cliente, compilando un form comprendente i seguenti campi: nome, cognome, email, indirizzo, contatto telefonico e password (richiesta due volte al fine di evitare errori).

#### RF5 Autenticazione {.unnumbered}
Il sistema deve permettere ad un utente anonimo di autenticarsi tramite un form, inserendo email e password.

#### RF6 Conferma email {.unnumbered}
Il sistema deve inviare all'email inserita in [RF4](#rf4-registrazione-cliente) un link per confermare tale email; la conferma dell'email avviene all'apertura del link. Quest'ultimo ha una scadenza di 24 ore e viene inviato nuovamente dalla pagina di autenticazione [RF5](#rf5-autenticazione), a seguito di un tentativo di accesso con email non verificata. Se l'email non è confermata, l'autenticazione non è permessa.

#### RF7 Recupero password {.unnumbered}
Per motivi di sicurezza ([RNF2](#rnf2-sicurezza)), il recupero e la visualizzazione della password non sono consentiti dal sistema. Pertanto, per poter accedere nuovamente all'applicazione, in seguito alla perdita della password, è necessario cambiarla. Il sistema quindi -- tramite la pagina mostrata da [RF5](#rf5-autenticazione) -- deve consentire ad un utente anonimo di inserire l'email di autentificazione per cui si vuole cambiare la password associata. A tale email sarà inviato il link ad una pagina in cui sarà permesso l'inserimento della nuova password tramite un form; all'invio di quest'ultimo, la password verrà cambiata. 

### Utente autenticato

#### RF8 Visualizzazione dati personali {.unnumbered}
Il sistema deve consentire la visualizzazione dei dati immessi in fase di registrazione ([RF4](#rf4-registrazione-cliente) o [RF24](#rf24-registrazione-dipendenti)) sotto forma di lista. Per motivi di sicurezza ([RNF2](#rnf2-sicurezza)), la password non viene visualizzata.

#### RF9 Modifica dati personali {.unnumbered}
Il sistema deve consentire attraverso un form -- raggiungibile da [RF8](#rf8-visualizzazione-dati-personali) o [RF25](#rf25-modifica-dati-dipendente) -- la modifica dei dati immessi in fase di registrazione ([RF4](#rf4-registrazione-cliente) o [RF23](#rf23-registrazione-dipendenti)). In tale form, ogni campo è inizialmente vuoto ed è possibile assegnargli un valore; una volta che il form è inviato, verranno modificati solo i campi non vuoti. La password viene richiesta due volte.

### Cliente

#### RF10 Acquisto impianto {.unnumbered}
Il sistema -- attraverso la selezione effettuta in [RF2](#rf2-visualizzazione-vetrina) -- deve permettere di effettuare l'acquisto dell'impianto selezionato, specificando indirizzo di installazione e superficie (in $m^2$) attraverso un form. All'invio di quest'ultimo, verrà richiesto il pagamento tramite PayPal. L'acquisto è considerato terminato dal momento in cui il pagamento con PayPal si conclude. Quando questo avviente, il sistema genera una richiesta di intervento di installazione per l'impianto acquistato.

#### RF11 Visualizzazione impianti acquistati {.unnumbered}
Il sistema deve consentire ad un cliente di visualizzare una lista di tutti gli impianti acquistati (attivi e dismessi), dove per ognuno dei quali viene mostrato: id, superficie (in $m^2$), indirizzo e stato (attivo o dismesso). Tra gli impianti visualizzati, il sistema deve permettere di selezionarne uno.

#### RF12 Visualizzazione misurazioni su *heatmap* {.unnumbered}
Il sistema -- attraverso la selezione effettuta in [RF11](#rf11-visualizzazione-impianti-acquistati) -- deve mostrare le misurazioni dei sensori dell'impianto selezionato sottoforma di heatmap. Quest'ultima deve considerare un parametro delle misurazioni alla volta, scelto tramite una lista. Sono considerate solo le misurazioni più recenti, presenti nella base di dati all’atto di caricamento della pagina. La mappa utilizzata è fornita da OpenStreetMap.

#### RF13 Visualizzazione misurazioni su tabella {.unnumbered}
Il sistema deve mostrare in una tabella -- raggiungibile dalla schermata [RF11](#rf11-visualizzazione-impianti-acquistati) -- tutte le misurazioni effettuate dai sensori dell'impianto selezionato. Tali misurazioni devono essere elencate in ordine cronologico, dalla più recente alla meno recente. La tabella, inoltre, deve contenere come colonne il *timestamp* della misurazione, l'id del sensore e in seguito una colonna per ogni parametro misurato.  
Per esempio, se si considera un impianto dove i parametri della misurazione sono temperatura, umidità, $CO_2$ e tVOC, la tabella deve avere la seguente struttura:

|ID|Timestamp|Temperatura [°C]|Umidità [%]|$CO_2$ [ppm]|tVOC [ppb]|
|---|---|---|---|---|---|

#### RF14 Visualizzazione interventi - cliente {.unnumbered}
Il sistema deve far visualizzare una lista -- raggiungibile dalla schermata [RF11](#rf11-visualizzazione-impianti-acquistati) -- di tutti gli interventi dell'impianto selezionato, dove per ognuno dei quali viene mostrato: data della richiesta, tipo di intervento e stato. Se l'intervento è assegnato in corso, allora vengono visualizzati anche nome e cognome del tecnico assegnato; se invece l'intervento è assegnato concluso, in aggiunta vengono mostrati: data della conclusione e resoconto dell'intervento. Inoltre, la lista deve elencare gli interventi in ordine cronologico: dalla data della richiesta più recente a quella meno recente.

#### RF15 Richiesta intervento di riparazione {.unnumbered}
Il sistema, se l'impianto selezionato in [RF11](#rf11-visualizzazione-impianti-acquistati) è attivo, deve consentire ad un cliente di richiedere un intervento di riparazione attraverso un form -- raggiungibile da [RF14](#rf14-visualizzazione-interventi-di-un-impianto) -- nel quale si dovrà inserire la motivazione della richiesta di intervento.

#### RF16 Richiesta recensione {.unnumbered}
Il sistema, dopo la terminazione di un acquisto, -- in aggiunta a quanto specificato in [RF10](#rf10-acquisto-impianto) -- deve inviare al cliente un'email contenente il link ad una pagina, in cui sarà permesso l'inserimento di una recensione su TrustPilot.

### Supervisore

#### RF17 Visualizzazione interventi - supervisore {.unnumbered}
Il sistema deve consentire ad un supervisore di visualizzare la lista di tutti gli interventi, dove per ognuno dei quali viene mostrato: nome del tipo e id dell'impianto, data della richiesta, tipo e stato dell'intervento; se l'intervento è assegnato concluso, viene visualizzata anche la data della conclusione. Inoltre, la lista deve elencare gli interventi in ordine cronologico: dalla data della richiesta più recente a quella meno recente. Tra gli interventi visualizzati, il sistema deve permettere di selezionarne uno.

#### RF18 Visualizzazione singolo intervento {.unnumbered}
Il sistema -- attraverso la selezione effettuata in [RF17](#rf17-visualizzazione-interventi---supervisore) -- deve mostrare tutti i dati dell'intervento selezionato già visualizzati in [RF17](#rf17-visualizzazione-interventi---supervisore) e inoltre: nome, cognome e contatto telefonico del cliente e indirizzo e superficie (in $m^2$) dell'impianto. Se l'intervento è assegnato in corso, allora vengono visualizzati anche nome, cognome e contatto telefonico del tecnico assegnato; se invece l'intervento è assegnato concluso, in aggiunta vengono mostrati: data della conclusione e resoconto dell'intervento.

#### RF19 Assegnazione intervento {.unnumbered}
Se l'intervento è in stato richiesto, il sistema -- tramite la pagina mostrata da [RF18](#rf18-visualizzazione-singolo-intervento) --  deve permettere ad un supervisore di assegnare un tecnico e decidere la data dell'intervento attraverso un form; in tale form, sono presenti due campi: data (nel formato gg/mm/aaaa) e lista dei tecnici (identificati da nome e cognome) che non hanno interventi assegnati per quella data. Il sistema mostra la lista dei tecnici disponibili solo in seguito all'inserimento di una data valida (giorno corrente o successivi).

### Tecnico

#### RF20 Registrazione sensore
Il sistema deve consentire ad un tecnico di registrare un sensore attraverso l'inseriemento dell'id del sensore considerato.

#### RF21 Visualizzazione interventi - tecnico {.unnumbered}
Il sistema deve mostrare una lista di tutti gli interventi assegnati al tecnico, dove per ognuno dei quali viene mostrato: nome del tipo, id, superficie e indirizzo dell'impianto, tipo, stato e data della richiesta dell'intervento, nome, cognome e contatto telefonico del cliente. Se l'intervento è assegnato concluso, allora viene visualizzata la data della conclusione. Inoltre, la lista deve elencare gli interventi in ordine cronologico: dalla data della richiesta più recente a quella meno recente. Tra gli interventi visualizzati, il sistema deve permettere di selezionarne uno.

#### RF22 Visualizzazzione e modifica singolo intervento {.unnumbered}
Il sistema -- attraverso la selezione effettuata in [RF20](#rf20-visualizzazione-interventi---tecnico) -- deve mostrare tutti i dati dell'intervento selezionato già visualizzati in [RF20](#rf20-visualizzazione-interventi---tecnico) e inoltre -- per gli interventi in stato assegnato concluso -- il resoconto dell'intervento. Per gli interventi in stato assegnato in corso, invece, il sistema, tramite un form, deve consentire al tecnico di inserire un resoconto e modificare lo stato dell'intervento in assegnato concluso.

#### RF23 Aggiunta/rimozione sensori {.unnumbered}
Se l'intervento è di tipo installazione/manutenzione/riparazione, il sistema -- tramite la pagina mostrata da [RF21](#rf21-visualizzazzione-e-modifica-singolo-intervento) -- deve permettere al tecnico di aggiungere un sensore all'impianto compilando un form, comprendente i campi id e coordinate geografiche del sensore (nello specifico, latitudine e longitudine). Inoltre, il sistema deve consentire anche la rimozione del sensore; in questo caso, il form richiede solo l'inserimento dell'id del sensore.  
Quest'ultimo deve poter essere immesso nei form sia tramite inserimento da tastiera che attraverso un codice QR ISO/IEC 18004:2006, inquadrato dalla fotocamera del dispositivo (se in dotazione) con cui si sta accedendo al sistema. In modo analogo, le coordinate geografiche devono poter essere immesse all'interno dei form sia tramite inserimento da tastiera che attraverso l'utilizzo del GPS del dispositivo (se in dotazione) con cui si sta accedendo al sistema.

### Amministratore

#### RF24 Registrazione dipendenti {.unnumbered}
Il sistema deve permettere ad un amministratore di registrare nel sistema i dipendenti dell'azienda; questo avviene tramite la compilazione di un form con i seguenti campi: nome, cognome, email, contatto telefonico, indirizzo, codice fiscale, password (generata automaticamente dal sistema) e ruolo del dipendente (selezionabile da una lista contenente supervisore, tecnico e amministratore). Al termine di tale operazione, il sistema deve inviare al dipendente un'email che specifica la password personale generata dal sistema e (per motivi di sicurezza precisati da [RNF2]([RNF2](#rnf2-sicurezza)) lo esorta a cambiarla (tramite [RF9](#rf9-modifica-dati-personali)).

#### RF25 Visualizzazione dipendenti {.unnumbered}
Il sistema deve far visualizzare una lista di tutti i dipendeti, dove per ognuno dei quali viene mostrato: nome, cognome, email, contatto telefonico, indirizzo, codice fiscale, password e ruolo. Tra i dipendenti visualizzati, il sistema deve permettere di selezionarne uno.

#### RF26 Modifica dati dipendente {.unnumbered}
Il sistema -- attraverso la selezione effettuata in [RF25](#rf25-visualizzazione-dipendenti) -- deve permettere ad un amministratore di modificare i dati personali del dipendente selezionato, tramite la procedura specificata in [RF9](#rf9-modifica-dati-personali).  
Si noti che solamente ad un amministratore è consentita la modifica dei dati personali di un dipendente dell'azienda.

#### RF27 Visualizzazione grafico degli impianti venduti {.unnumbered}
Il sistema deve far visualizzare un grafico dove si mostra in funzione del tempo -- con granularità mensile -- il numero totale di acquisti effettuati dai clienti.

#### RF28 Visualizzazione grafico degli interventi {.unnumbered}
Il sistema deve far visualizzare un grafico dove si mostra in funzione del tempo -- con granularità mensile -- il numero totale di interventi effettuati sugli impianti.

## Requisiti Non Funzionali

#### RNF1 Privacy {.unnumbered}
Il sistema deve rispettare il regolamento europeo 2016/679 noto come GDPR (General Data Protection Regulation).

#### RNF2 Sicurezza {.unnumbered}
Il sistema deve utilizzare connessioni https. La password non deve essere salvata in chiaro, e dunque non può essere visualizzata in [RF8](#rf8-visualizzazione-dei-dati-personali) e non può essere inviata direttamente in [RF6](#rf7-recupero-della-password): dunque il recupero password effettua un cambio della password. Non deve essere possibile dato un indirizzo email comprendere se quell'indirizzo email è registrato, e dunque in [RF7](#rf7-recupero-della-password), supponendo che l'utente inserisca un indirizzo email non registrato, il sistema non deve avvertire l'utente che l'indirizzo email non è registrato. 

#### RNF3 Facilità d'uso {.unnumbered}
I tecnici devono imparare ad usare le funzioni [RF20](#rf20-registrazione-sensore), [RF21](#rf21-visualizzazione-lista-interventi-assegnati), [RF22](#rf22-visualizzazzione-e-modifica-intervento-assegnato), [RF23](#rf23-aggiuntarimozione-sensori-da-impianto) con un addestramento specifico inferiore a 15 minuti. I supervisori devono imparare ad usare le funzioni [RF17](#rf17-visualizzazione-lista-interventi), [RF18](#rf18-visualizzazione-intervento), [RF19](#rf19-assegnazione-intervento) con un addestramento specifico inferiore a 15 minuti.
L'id sensore in [RF20](#rf20-registrazione-sensore), [RF23](#rf23-aggiuntarimozione-sensori-da-impianto) deve essere compilabile sia con scrittura da tastiera che inquadrando un codice QR ISO/IEC 18004:2006 con la fotocamera del dispositivo con cui si utilizza il sistema.
Un utente anonimo deve essere in grado di registrarsi e portare a termine un acquisto ([RF2](#rf2-visualizzazione-vetrina), [RF4](#rf4-registrazione-cliente),[RF10](#rf10-acquisto-impianto)) senza alcun addestramento, imparando in autonomia in meno di 5 minuti.

#### RNF4 Prestazioni {.unnumbered}
Le funzioni dei tecnici [RF20](#rf20-registrazione-sensore), [RF21](#rf21-visualizzazione-lista-interventi-assegnati), [RF22](#rf22-visualizzazzione-e-modifica-intervento-assegnato), [RF23](#rf23-aggiuntarimozione-sensori-da-impianto) devono essere eseguite in al più 5 secondi; la funzione del cliente [RF12](#rf12-visualizzazione-misurazioni-su-heatmap) deve essere eseguita dal sistema in al più 3 secondi; la funzione di acquisto [RF10](#rf10-acquisto-impianto) deve essere eseguita dal sistema in al più 3 minuti.
Per i RF con form la misurazione avviene da quando il form è inviato a quando si ha la conferma di ricezione; per i RF di visualizzazione la misurazione avviene dall'immisione dell'URL al caricamento completo della pagina. La misurazione è effettuata sulla rete intranet di Ardeeno, con il sistema installato nei server locali di Ardeeno ed il dispositivo da cui si accede al sistema connesso alla stessa rete locale.

#### RNF5 Portabilità {.unnumbered}
Ogni funzione deve essere funzionante:

- sui seguenti browser:
  - Chrome +
  - Chrome Mobile +
  - Safari +
  - Safari Mobile +

- sui seguenti sistemi operativi:
  - Windows +
  - MacOS +
  - Android +
  - IOS +

Le funzioni [RF.Tecnico](#tecnico), [RF.Supervisore](#supervisore), [RF.Amministratore](#amministratore) devono in aggiunta essere funzionanti:

- sui seguenti browser:
  - Firefox +
  - Firefox Mobile +

- sui seguenti sistemi operativi:
  - Ubuntu 20.04+

#### RNF6 Scalabilità {.unnumbered}
Il sistema deve mantenere le prestazione descritte in [RNF4](#rnf4-prestazioni) anche con:

1. 100 tecnici che contemporaneamente usano [RF.Tecnico](#tecnico)
2. 10000 utenti anonimi che contemporaneamente usano [RF2](#rf2-visualizzazione-vetrina)
3. 1000 clienti che contemporaneamente usano [RF10](#rf10-acquisto-impianto), [RF12](#rf12-visualizzazione-misurazioni-su-heatmap)
4. 1000 impianti nel sistema e per ogni impianto $100*24*30*12*5=4320000$ misurazioni con 10 parametri misurati
5. 1, 2, 3, 4 tutte contemporaneamente

## Design Front-end

## Design Back-end
