---
title: | 
  ![](../../.common-media/logo-unitn-ardeeno-512.png){width=10cm}

  Ardeeno WebApp
subtitle: |
  T41-SE22

  D2-Documento di Specifica

  v1.0
author: [alessandro.manfucci@studenti.unitn.it, enrico.cescato@studenti.unitn.it ,m.sottocornola-1@studenti.unitn.it]
date: "16-11-2022"
lang: it
format:
  pdf:
    include-in-header:
      text: |
        \usepackage{graphicx}
        \usepackage{wrapfig}
    documentclass: article
    classoption: titlepage
    toc: true
    toc-title: Indice
    papersize: a4
    number-sections: true
    geometry:
    - top=1in
    - bottom=1in
    - right=1in
    - left=1in
---

\pagebreak
# Abstract {.unlisted .unnumbered}

Questo documento descrive in maniera più dettagliata -- ma sempre non tecnica -- i requisiti del sistema da realizzare. Per i requisiti funzionali si utilizza il linguaggio di modellazione UML, mentre per i requisiti non funzionali si utilizzano particolari tabelle. Vedremo poi nel dettaglio il contesto del sistema da realizzare, ovvero gli attori ed i sistemi esterni, e poi descriveremo una prima architettura in componenti.

# Terminologia {-}

- **misurazione**: tupla contenente un valore per ogni parametro misurato. 

- **ciclo di polling**: periodo di tempo in cui la stazione di polling -- compresa nell'impianto -- richiede ad ogni sensore le loro misurazioni.

- **intervallo di polling (PI)**: periodo di tempo che occorre tra l'inizio di due cicli di polling. Il ciclo di polling ha durata estremamente breve rispetto all'intervallo di polling. I sensori calcolano ogni valore di una misurazione aggregando in media i dati raccolti durante l'intervallo di polling. Ogni modello di impianto specifica i parametri misurati e l'intervallo di polling.

- **snapshot**: insieme delle misurazioni raccolte in un certo ciclo di polling. Ogni misurazione di uno snapshot ha lo stesso timestamp.

- **modelli**:  
modello=tipo+num.sensori+variante+versione  
tipo=("TR", "AQ", "FP", "TE", "WQ", "ME") // Specifica i parametri misurati  
num.sensori=("10", "50", "100", "200", "500")  
variante=("A", "B", "C") // A => PI=5m, B => PI=30m, C => PI=3h  
versione=(" ", "0", "1", "2", ...) // Hardware differente

# Requisiti funzionali
Questo capitolo presenta i requisiti funzionali del sistema, raggruppati per ruolo. Vengono utilizzati i diagrammi UML Use Case (descrivendo nel dettaglio ogni singolo Use Case) e, per i requisiti funzionali più complessi, anche i Sequence Diagrams, gli Activity Diagrams e gli State Diagrams.

Si evidenzia la seguente gerarchia disgiunta di Attori:

![Gerarchia Attori](.media/gerarchia.png){width=10cm fig-pos=H}

Il punto di vista è sempre quello del sistema; dunque un utente, anche se registrato, verrà considerato come Utente Anonimo fino al momento del Login.

<!--FORM
1. Il <attore> inserisce X [Exception 1]
2. Il <attore> invia il form premendo il bottone "<bottone>" [Exception 2]
3. <qualcosa> è stato correttamente <fatto> ed appare la scritta "<scritta>"
Exceptions
1. X non è valido (<motivo>), il bordo del campo del form diventa rosso.
2. Vi è almeno un campo del form vuoto o non valido, appare in rosso la scritta "Compila correttamente il form".
-->

<!--
1. L'utente anonimo riceve un'email da *<component>.ardeeno@gmail.com* con oggetto "<oggetto>".

2. L'utente anonimo visualizza il messaggio dell'email e preme sul link con testo "<testo>"

3. Il sistema <fa qualcosa> e mostra una pagina con scritto "<Ho fatto qualcosa>"
-->

<!--CONTROLLO ERRORI
\*\*\*.*\*\*\*\n\w+
^\d\.\s*[\w\s\d'",\-/:\*()èéÈÉàù@;]+\.
-->

## Utente anonimo

![RF1, RF2, RF2.1, RF3](.media/anonimo1.png){width=10cm fig-pos=H}

### UseCase Visualizzazione presentazione {-}

***Summary***

Questo use case descrive la visualizzazione da parte di un utente anonimo della presentazione dell'azienda.

***Description***

1. L'utente anonimo visualizza una breve descrizione dell'azienda.

2. L'utente anonimo visualizza una mappa fornita da OpenStreetMap, in cui è evidenziata la posizione delle sedi dell'azienda.

3. L'utente anonimo visualizza indirizzo email e numero di telefono dell'azienda. [Extension 1]

***Extensions***

1. L'utente preme il bottone "Copia", posto a fianco dell'indirizzo email/numero di telefono, e copia sulla clipboard del dispositivo con cui si sta accedendo al sistema l'indirizzo email/il numero di telefono.

### UseCase Visualizzazione vetrina {-}

***Summary***

Questo use case descrive la visualizzazione da parte di un utente anonimo dei modelli di impianto in vendita.

***Description***

1. L'utente anonimo visualizza una lista dei modelli di impianto in vendita. [Exception 1] [Extension 1] [Extension 2]

2. L'utente anonimo seleziona uno specifico filtro dal menu dei filtri, che consente di filtrare i modelli per: tipo, prezzo, superficie consigliata. [Exception 1]

***Exceptions***

1. Nessun impianto soddisfa il filtro selezionato; la lista è vuota e compare la scritta "Nessun impianto".

***Extensions***

1. L'utente anonimo seleziona uno specifico modello di impianto e visualizza inoltre le *product reviews* di TrustPilot. [Extension 2]

2. L'utente anonimo seleziona uno specifico filtro dal menu dei filtri, che consente di filtrare le recensioni per: valutazione in stelle, data.

### UseCase Visualizzazione recensioni {-}

***Summary***

Questo use case descrive la visualizzazione da parte di un utente anonimo delle *service reviews* di TrustPilot.

***Description***

1. L'utente anonimo visualizza una lista delle dieci più recenti *service reviews* con almeno quattro stelle. [Exception 1]

2. L'utente anonimo visualizza il *TrustScore* dell'azienda, fornito dal servizio TrustPilot. [Exception 2]

***Exceptions***

1. Non ci sono *service reviews*; compare la scritta "Nessuna recensione disponibile".

2. Non ci sono *service reviews*; compare la scritta "TrustScore non disponibile".

![RF4, RF5, RF6, RF7](.media/anonimo2.png){width=10cm fig-pos=H}

### UseCase Registrazione cliente {-}
***Summary***

Questo use case descrive come l'utente anonimo effettua la registrazione come cliente nel sistema tramite form.

***Description***

1. L'utente anonimo inserisce il nome e il cognome. [Exception 1]

2. L'utente anonimo inserisce l'indirizzo email. [Exception 2]

3. L'utente anonimo inserisce il numero di telefono. [Exception 3]

4. L'utente anonimo inserisce l'indirizzo di domicilio. [Exception 4]

5. L'utente anonimo inserisce due volte la password. [Exception 5]

5. L'utente anonimo invia il form premendo il bottone "Registrati". [Exception 6] [Exception 7]

6. Il sistema -- tramite Gmail -- invia due email: una contenente il codice per confermare l'indirizzo email, l'altra con i dati di registrazione e un messaggio di benvenuto.

7. La registrazione è stata correttamente effettuata, appare la scritta "Registrazione completata".

***Exceptions***

1. Il nome e/o il cognome non è valido \(non soddisfa la regex "\[A-Za-z\]\{3,20\}"\), il bordo del campo del form diventa rosso.

2. L'indirizzo email non è valido \(non soddisfa la regex ".\*@.\*"\), il bordo del campo del form diventa rosso.

3. Il numero di telefono non è valido (non soddisfa la regex "(.\\d*) \\d\{10\}" \), il bordo del campo del form diventa rosso.

4. L'indirizzo non è valido, il bordo del campo del form diventa rosso.

5. Le due password non sono congruenti oppure la prima non e valida ([RNF2 Sicurezza](#rnf2-sicurezza)), il bordo del campo del form diventa rosso.

6. Vi è almeno un campo del form vuoto o non valido, appare in rosso la scritta "Compila correttamente il form".

7. L'indirizzo email inserito è già utilizzato da un altro account, appare la scritta "Indirizzo email già utilizzato".

### UseCase Conferma indirizzo email {-}
***Summary***

Questo use case descrive come avviene la conferma dell'indirizzo email inserito nella registrazione da parte dell'utente anonimo.

***Description***

1. L'utente anonimo riceve un'email da *accounts.ardeeno@gmail.com* con oggetto "Conferma indirizzo email".

2. L'utente anonimo visualizza il messaggio dell'email e preme sul link con testo "Conferma il mio indirizzo email". [Exception 1]

3. Il sistema conferma l'indirizzo email e mostra una pagina con scritto "Indirizzo email confermato".

***Exceptions***

1. Dal momento dell'invio dell'email all'apertura del link sono trascorse più di 24h, il link non è più valido ed appare la scritta "Indirizzo email non confermato, link non valido"!

### UseCase Autenticazione {-}

***Summary***

Questo use case descrive come l'utente anonimo effettua l'autenticazione tramite form.

***Description***

1. L'utente anonimo inserisce l'indirizzo email. [Exception 1]

2. L'utente anonimo inserisce la password.

3. L'utente anonimo invia il form premendo il bottone "Login". [Exception 2]

4. Il sistema verifica che l'indirizzo email inserito appartenga ad un account. [Exception 3]

5. Il sistema verifica che l'indirizzo email inserito sia stato confermato. [Exception 4]

5. Il sistema verifica che la password sia corretta. [Exception 5]

6. L'autenticazione è conclusa, l'utente è portato alla pagina degli impianti o degli interventi.

***Exceptions***

1. L'indirizzo email non è valido \(non soddisfa la regex ".\*@.\*"\), il bordo del campo del form diventa rosso.

2. Vi è almeno un campo del form vuoto o non valido, appare in rosso la scritta "Compila correttamente il form".

3. L'indirizzo email non appartiene ad alcun account o appartiene all'account di un Dipendente dimesso, appare la scritta "Indirizzo email non corretto".

4. L'indirizzo email non è confermato; il sistema -- tramite Gmail -- invia all'indirizzo email un nuovo link per confermare tale indirizzo email ed appare la scritta "Inviato nuovo link di conferma!"; il link precedente non è più valido.

5. La password non è corretta, appare la scritta "Password non corretta" ed il link alla pagina "Recupera password".

### UseCase Recupero password {-}
***Summary***

Questo use case descrive come avviene il recupero -- ovvero il cambio -- della password da parte di un utente anonimo.

***Description***

1. L'utente anonimo inserisce l'indirizzo email. [Exception 1]

2. L'utente anonimo invia il form premendo il bottone "Recupera password". [Exception 2]

3. Il sistema -- tramite Gmail -- invia all'indirizzo email inserito un link per recuperare la password. 

4. L'utente anonimo riceve un'email da *accounts.ardeeno@gmail.com* con oggetto "Recupero password".

5. L'utente anonimo visualizza il messaggio dell'email e preme sul link con testo "Modifica la mia password". [Exception 3]

6. L'utente anonimo visualizza il form ed inserisce due volte la nuova password.

7. L'utente anonimo invia il form premendo il bottone "Modifica password". [Exception 4]

8. Il sistema modifica la password dell'account.

***Exceptions***

1. L'indirizzo email non è valido \(non soddisfa la regex ".\*@.\*"\), il bordo del campo del form diventa rosso.

2. L'indirizzo email non appartiene ad alcun account o appartiene all'account di un Dipendente dimesso, appare la scritta "Indirizzo email non corretto".

3. Dal momento dell'invio dell'email all'apertura del link sono trascorse più di 24h, il link non è più valido ed appare la scritta "Recupero non possibile, link non valido!".

4. Le due password non sono congruenti oppure la prima non e valida ([RNF2 Sicurezza](#rnf2-sicurezza)), il bordo del campo del form diventa rosso.

## Utente autenticato

![RF5.1, RF8, RF9](.media/autenticato.png){width=12cm fig-pos=H}

### UseCase Logout {-}

***Summary***

Questo use case descrive come un Utente Autenticato effettua il logout dal sistema.

***Description***

1. L'utente autenticato preme il bottone "Logout".

2. Il sistema riporta l'utente alla pagina di presentazione; l'utente non è più autenticato.

### UseCase Visualizzazione dati personali {-}

***Summary***

Questo use case descrive come l'utente autenticato visualizza i suoi dati personali.

***Description***

1. L'utente autenticato visualizza una pagina contenente la lista dei dati personali. Vi è un link alla pagina di modifica [Extension 1].

***Extensions***

1. Se l'utente è un dipendete vi è in aggiunta il campo CF.

### UseCase Modifica dati personali{-}

***Summary***

Questo use case descrive come l'utente autenticato modifica i propri dati personali.

***Description***

1. L'utente autenticato visualizza un form contenente tutti i campi presenti nella registrazione Cliente.

2. L'utente riempie certi campi. [Exception 1] 

3. L'utente invia il form premendo il tasto "Modifica dati". [Exception 2] [Exception 3]

4. Il sistema aggiorna solo quei campi riempiti ed invia un'email di notifica tramite Gmail.

***Exceptions***

1. Se certi campi non sono validi, il bordo diventa rosso.

2. Alcuni campi non sono validi o nessun campo è riempito, appare la scritta "Compila correttamente il form".

3. Il nuovo indirizzo email che è stato inserito è già presente nel sistema.

***Extensions***

1. È stato inserito un nuovo indirizzo email; viene inviata una nuova email di conferma tramite Gmail.

## Cliente

![RF10, RF16](.media/cliente1.png){width=10cm fig-pos=H}

### UseCase Acquisto impianto {-}
  
***Summary***

Questo use case descrive come il cliente effettua l'acquisto dell'impianto precedentemente selezionato.

***Description***

1. Il cliente inserisce l'indirizzo di installazione. [Exception 1]

2. Il cliente inserisce la superficie in $m^2$. [Exception 2]

3. Il cliente invia il form premendo il bottone "Acquista", al cui lato è presente il costo del tipo di impianto. [Exception 3]

4. Il cliente effettua il pagamento tramite PayPal. [Exception 4]

5. L'acquisto è concluso, nella pagina di acquisto appare in verde la scritta "Acquisto concluso!".

6. L'acquisto è concluso, il sistema inserisce un intervento di installazione per il nuovo impianto ed -- tramite Gmail -- invia una richiesta di recensione e un messaggio di avvenuto acquisto.

***Exceptions***

1. L'indirizzo non è valido, il bordo del campo del form diventa rosso.

2. La superficie non è valida (non è un intero positivo), il bordo del campo del form diventa rosso.

3. I campi indirizzo o superficie sono vuoti o non validi, appare in rosso la scritta "Compila correttamente il form".

4. PayPal riporta che il pagamento non è andato a buon fine, appare in rosso la scritta "Acquisto annullato - Pagamento non andato a buon fine".

***Sequence Diagram***

![Sequence Diagram](.media/cliente1seq.png){width=7cm fig-pos=H}

### UseCase Pagamento {-}  

***Summary***

Questo use case descrive come avviene il pagamento dell'impianto tramite PayPal.

***Description***

1. Il cliente si collega al sistema PayPal.

2. Il cliente effettua il pagamento tramite PayPal. [Exception 1]

3. Il cliente ritorna al sistema Ardeeno WebApp.

***Exceptions***

1. PayPal riporta che il pagamento non è andato a buon fine.

### UseCase Richiesta Recensione {-}  

***Summary***

Questo use case descrive come avviene la richiesta e l'inserimento di una recensione su TrustPilot da parte del cliente.

***Description***

1. Il cliente riceve un'email da *sales.ardeeno@gmail.com* con oggetto "Acquisto concluso".

2. Il cliente visualizza il messaggio dell'email e clicca sul link con testo "Recensisci il modello di impianto!".

3. Il cliente si collega al sistema TrustPilot ed inserisce una recensione.

4. TrustPilot riporta che la recensione è stata correttamente inserita.

![RF11, RF12, RF13](.media/cliente2.png){width=12cm fig-pos=H}

### UseCase Visualizzazione Impianti Acquistati {-}  

***Summary***

Questo use case descrive la visualizzazione da parte di un cliente degli impianti acquistati.

***Description***

1. Il cliente visualizza la lista di tutti gli impianti acquistati; è attivo il filtro Tutti. [Exception 1] [Extension 1] [Extension 2] [Extension 3]

***Exceptions***

1. Nessun impianto soddisfa tale filtro; la lista è vuota ed appare la scritta "Nessun impianto".

***Extensions***

1. Il cliente seleziona uno specifico impianto e visualizza la Dashboard dell'impianto.

2. Il cliente seleziona il filtro Tutti, Attivi o Dismessi. [Exception 1]

3. Il cliente seleziona il menu degli ulteriori filtri e seleziona uno specifico filtro (tra cui vi sono tutti i modelli e tutti i tipi degli impianti acquistati). [Exception 1]

### UseCase Dashboard {-}

***Summary***

Questo use case descrive come il cliente interagisce con la Dashboard dell'impianto selezionato.

***Description***

1. Il cliente visualizza le informazioni del singolo impianto (ID, indirizzo, modello, stato, data acquisto, superficie) e le funzioni disponibili (Heatmap, visualizzazione su tabella, visualizzazione interventi).

2. Il cliente seleziona una funzione. 

### UseCase Visualizzazione misurazioni su tabella {-}  

***Summary***

Questo use case descrive come un cliente visualizza le misurazioni di uno specifico impianto su tabella.

***Description***

1. Il cliente visualizza una tabella contenente tutte le misurazioni ordinate per data da più recente a meno recente.

2. Il cliente clicca un bottone per aggiornare la tabella con le più recenti misurazioni. [Exception 1]

***Exceptions***

1. L'impianto è dismesso e non è presente tale bottone

### UseCase Visualizzazione misurazioni su heatmap {-}  

***Summary***

Questo use case descrive come un cliente visualizza le misurazioni di uno specifico impianto su heatmap.

***Description***

1. La heatmap mostra lo snapshot più recente dell'impianto considerando un parametro arbitrario. Per ogni misurazione nello snapshot, il valore del parametro considerato è posizionato sulla mappa alle coordinate del dato sensore. Il valore del parametro considerato è rappresentato con una scala di colori dal giallo (valore minimo assoluto) al rosso (valore massimo assoluto). Le mappe sono reperite da OpenStreetMap.

2. Il cliente seleziona il parametro considerato da una lista contenente tutti i parametri misurati dall'impianto selezionato.

3. Il cliente clicca su un bottone per visualizzare lo snapshot precedente (meno recente). [Exception 1]

4. Il cliente clicca su un bottone per visualizzare lo snapshot successivo (più recente). [Exception 2]

***Exceptions***

1. Lo snapshot attuale è il meno recente in assoluto, viene visualizzata con pop-up la scritta "Nessuno snapshot precedente".

2. Lo snapshot attuale è il più recente in assoluto, viene visualizzata con pop-up la scritta "Nessuno snapshot successivo".

![RF14, RF15](.media/cliente3.png){width=10cm fig-pos=H}

### UseCase Visualizzazione interventi {-}  

***Summary***

Questo use case descrive come un cliente visualizza gli interventi effettuati su uno specifico impianto su heatmap.

***Description***

1. Il cliente visualizza la lista di tutti gli interventi effettuati sull'impianto selezionato; è attivo il filtro Tutti. [Exception 1] [Extension 1] [Extension 2]

***Exceptions***

1. Nessun intervento soddisfa tale filtro; la lista è vuota ed appare la scritta "Nessun intervento".

***Extensions***

1. Il cliente seleziona il filtro Tutti, Richiesti, In Corso, Conclusi. [Exception 1]

2. Il cliente seleziona il menu degli ulteriori filtri e seleziona uno specifico filtro (Installazioni, Manutenzioni, Riparazioni, Dismissioni). [Exception 1]

### UseCase Richiesta intervento di riparazione {-}

***Summary***

Questo use case descrive come un cliente richiede un intervento di riparazione per l'impianto selezionato.

***Description***

1. Il cliente clicca sul bottone "Richiedi riparazione". [Exception 1]

2. Il cliente inserisce la motivazione della riparazione.

3. Il cliente invia la richiesta di riparazione.

***Exceptions***

1. L'impianto è dismesso ed il bottone non è presente.

## Supervisore

![RF17, RF18, RF19](.media/supervisore1.png){width=12cm fig-pos=H}

### UseCase Visualizzazione interventi {-}  

***Summary***

Questo use case descrive la visualizzazione da parte del supervisore di tutti gli interventi.

***Description***

1. Il supervisore visualizza la lista di tutti gli interventi; è attivo il filtro Tutti. [Exception 1] [Extension 1] [Extension 2]

2. Il supervisore seleziona uno specifico intervento e appare un pop-up con ulteriori informazioni e con un link per assegnare l'intervento al tecnico. [Exception 2]

***Exceptions***

1. Nessun intervento soddisfa tale filtro; la lista è vuota e appare la scritta "Nessun intervento".

2. L'intervento è assegnato; non si mostra il link per assegnare l'intervento al tecnico.

***Extensions***

1. Il supervisore seleziona il filtro Tutti, Richiesti, In Corso, Conclusi. [Exception 1]

2. Il supervisore seleziona il menu degli ulteriori filtri e seleziona uno specifico filtro (Installazioni, Manutenzioni, Riparazioni, Dismissioni). [Exception 1]

### UseCase Assegnazione intervento {-}

***Summary***

Questo use case descrive come un supervisore assegna l'intervento precedentemente selezionato a un tecnico in una certa data.

***Description***

1. Il supervisore clicca sul campo data ed appare un calendario.

2. Il supervisore seleziona una data dal calendario; non sono selezionabili i giorni precedenti a quello corrente ed i festivi.

3. Il sistema mostra una lista (nome, cognome) dei tecnici liberi in quella data. [Exception 1]

4. Il supervisore seleziona un tecnico dalla lista ed il sistema controlla nuovamente la disponibilità e lo considera *Prenotato*. [Exception 2]

5. Appare il bottone "Assegna" ed il supervisore lo preme. Ad assegnazione conclusa viene inviata un'email di notifica al dato tecnico. [Exception 3]

***Exceptions***

1. Non vi sono tecnici liberi in quella data, quindi la lista è vuota e appare la scritta "Nessun tecnico disponibile".

2. Dal momento di selezione della data al momento di selezione del tecnico, il dato tecnico è stato *prenotato* o assegnato ad un intervento; appare la scritta "Tecnico non disponibile" e viene caricata nuovamente la lista dei tecnici.

3. Sono trascorsi più di 15 minuti dalla selezione del tecnico; appare la scritta "Tempo scaduto, ripeti l'operazione" e si rimuove la *prenotazione* del tecnico e la selezione della data.

***Activity Diagram***

![Activity Diagram](.media/supervisore1activity.png){width=10cm fig-pos=H}

## Tecnico

![RF20, RF21, RF22](.media/tecnico1.png){width=12cm fig-pos=H}

### UseCase Visualizzazione interventi {-}  

***Summary***

Questo use case descrive come un tecnico visualizza gli interventi che gli sono stati assegnati.

***Description***

1. Il tecnico visualizza la lista di tutti gli interventi; è attivo il filtro Tutti. [Exception 1] [Extension 1] [Extension 2]

2. Il tecnico seleziona uno specifico intervento e appare un pop-up con ulteriori informazioni e con un link per aggiungere/rimuovere sensori e per concludere l'intervento. [Exception 2]

***Exceptions***

1. Nessun intervento soddisfa tale filtro; la lista è vuota e appare la scritta "Nessun intervento".

2. L'intervento è concluso; non si mostrano tali link.

***Extensions***

1. Il supervisore seleziona il filtro Tutti, Richiesti, In Corso, Conclusi. [Exception 1]

2. Il tecnico seleziona il menu degli ulteriori filtri e seleziona uno specifico filtro (Installazioni, Manutenzioni, Riparazioni, Dismissioni). [Exception 1]

### UseCase Conclusione intervento {-}  

***Summary***

Questo use case descrive come un tecnico conclude l'intervento precedentemente selezionato.

***Description***

1. Il tecnico inserisce il resoconto testuale dell'intervento.

2. Il sistema inserisce automaticamente nel form la data corrente.

3. Il tecnico invia il form premendo sul bottone "Concludi".

### UseCase Aggiunta sensore {-}  

***Summary***

Questo use case descrive come un tecnico aggiunge un sensore all'impianto relativo all'intervento in corso precedentemente selezionato.

***Description***

1. Il tecnico inserisce da tastiera l'ID alfanumerico del sensore. [Exception 1] [Extension 1]

2. Il tecnico inserisce da tastiera latitudine e longitudine in gradi decimali. [Exception 2] [Extension 2]

3. Il tecnico invia il form premendo il bottone "Aggiungi". [Exception 3]

4. Il sensore è stato correttamente aggiunto ed appare la scritta "Sensore aggiunto".

***Exceptions***

1. L'ID non è valido \(non soddisfa la regex "\[\\dA-Za-z\]\{10\}"\), il bordo del campo del form diventa rosso.

2. Le coordinate non sono valide (non sono un numero), il bordo del campo del form diventa rosso.

3. I campi ID o coordinate sono vuoti o non validi, appare in rosso la scritta "Compila correttamente il form".

4. Il dispositivo con cui si accede ad Ardeeno WebApp non dispone di GPS; appare la scritta "GPS Non disponibile".

***Extensions***

1. Il tecnico preme un bottone al lato, inquadra con la fotocamera il codice qr del sensore ed l'ID è inserito dal sistema.

2. Il tecnico preme un bottone al lato ed il GPS inserisce automaticamente le coordinate. [Exception 4]

### UseCase Rimozione sensore {-}  

***Summary***

Questo use case descrive come un tecnico rimuove un sensore dall'impianto relativo all'intervento precedentemente selezionato.

***Description***

1. Il tecnico inserisce da tastiera l'ID alfanumerico del sensore [Exception 1] [Extension 1]

2. Il tecnico invia il form premendo il bottone "Rimuovi" [Exception 2]

3. Il sensore è stato correttamente aggiunto ed appare la scritta "Sensore rimosso"

***Exceptions***

1. L'ID non è valido \(non soddisfa la regex "\[\\dA-Za-z\]\{10\}"\), il bordo del campo del form diventa rosso.

2. Il campo ID è vuoto o non valido, appare in rosso la scritta "Compila correttamente il form".

## Amministratore

![RF23, RF24, RF25, RF26, RF27](.media/amministratore1.png){width=12cm fig-pos=H}

### UseCase Registrazione dipendente {-}  

***Summary***

Questo use case descrive come avviene la registrazione di un dipendente da parte di un amministratore.

***Description***

1. L'amministratore inserisce il nome e il cognome. [Exception 1]

2. L'amministratore inserisce l'indirizzo email. [Exception 2]

3. L'amministratore inserisce il numero di telefono. [Exception 3]

4. L'amministratore inserisce l'indirizzo di domicilio. [Exception 4]

5. L'amministratore inserisce il CF. [Exception 5]

6. L'amministratore seleziona il ruolo del dipendente da una lista contenente: tecnico, supervisore o amministratore.

7. L'amministratore invia il form premendo il bottone "Registra dipendente". [Exception 6] [Exception 7].

8. Il sistema -- tramite Gmail -- invia l'email contenente la password generata automaticamente per il nuovo account.

9. Il sistema -- tramite Gmail -- invia l'email per il recupero della password -- come sollecito a modificare la password.

10. L'indirizzo email è automaticamente confermato.

11. La registrazione è stata correttamente effettuata, appare la scritta "Registrazione completata" ed il sistema -- tramite Gmail -- invia al Dipendente una notifica di avvenuta registrazione.

***Exceptions***

1. Il nome e/o il cognome non è valido \(non soddisfa la regex "\[A-Za-z\]\{3,20\}"\), il bordo del campo del form diventa rosso.

2. L'indirizzo email non è valido \(non soddisfa la regex ".\*@.\*"\), il bordo del campo del form diventa rosso.

3. Il numero di telefono non è valido (non soddisfa la regex "(.\\d*) \\d\{10\}" \), il bordo del campo del form diventa rosso.

4. L'indirizzo non è valido, il bordo del campo del form diventa rosso.

5. Il CF non è valido, il bordo del campo del form diventa rosso.

6. Vi è almeno un campo del form vuoto o non valido, appare in rosso la scritta "Compila correttamente il form".

7. Il CF o l'indirizzo email inserito sono già presenti nella BD, appare la scritta "Dipendente già registrato".

### UseCase Visualizzazione lista dipendenti {-}  

***Summary***

Questo use case descrive come un amministratore visualizza la lista di tutti i dipendenti.

***Description***

1. L'amministratore visualizza la lista di tutti i dipendenti; è attivo il filtro Tutti. [Exception 1] [Extension 1] [Extension 2]

2. L'amministratore seleziona uno specifico dipendente dalla lista.

***Exceptions***

1. Nessun dipendente soddisfa tale filtro; la lista è vuota e appare la scritta "Nessun dipendente".

***Extensions***

1. L'amministratore seleziona il filtro Tutti, Attivi, Dimessi. [Exception 1]

2. L'amministratore seleziona il menu degli ulteriori filtri e seleziona uno specifico filtro (Clienti, Tecnici, Supervisori, Amministratori). [Exception 1]

### UseCase Modifica dati dipendente {-}  

***Summary***

Questo use case descrive come un amministratore modifica i dati di un dipendente della azienda.

***Description***

1. L'amministratore compila almeno uno dei campi descritti nella [Registrazione dipendente](#usecase-registrazione-dipendente). [Extension 1]

3. L'amministratore invia il form premendo il bottone "Modifica dati". Ad avvenuta modifica il sistema -- tramite Gmail -- invia un'email di notifica al Dipendente. [Exception 1]

***Exceptions***

1. Tutti i campi del form sono vuoti o vi è almeno un campo non valido, appare in rosso la scritta "Compila correttamente il form".

***Extensions***

1. L'amministratore segna il dipendente come dimesso o non dimesso.

### UseCase Visualizzazione grafico vendite {-}  

***Summary***

Questo use case descrive la visualizzazione da parte di un amministratore del grafico delle vendite.

***Description***

1. L'amministratore visualizza il grafico delle vendite con granularità mensile; inizialmente comprende il massimo intervallo possibile. [Extension 1] [Extension 2]

***Extensions***

1. L'amministratore seleziona un punto sull'asse del tempo ed appare un pop-up con il numero esatto di impianti venduti in quel mese.

2. L'amministratore seleziona un intervallo sull'asse del tempo ed il grafico si adatta al nuovo intervallo considerato.

### UseCase Visualizzazione grafico interventi {-}  

***Summary***

Questo use case descrive la visualizzazione da parte di un amministratore del grafico degli interventi effettuati.

***Description***

1. L'amministratore visualizza il grafico degli interventi effettuati con granularità mensile; inizialmente comprende il massimo intervallo possibile. [Extension 1] [Extension 2]

***Extensions***

1. L'amministratore seleziona un punto sull'asse del tempo ed appare un pop-up con il numero di interventi richiesti (sia totale che suddiviso per tipo). 

2. L'amministratore seleziona un intervallo sull'asse del tempo ed il grafico si adatta al nuovo intervallo considerato.

\pagebreak
# Requisiti Non Funzionali

### RNF1 Privacy {-}

|Proprietà|Descrizione|Misura|
|---|------|------|
|GDPR|Il sistema deve rispettare il regolamento europeo 2016/679 noto come GDPR (General Data Protection Regulation).|Conforme: Privacy Policy, richiesta del consenso per l'utilizzo di Cookies, possibilità di cancellare i propri dati (account e impianti), possibilità di esportare i propri dati (account e impianti) |

### RNF2 Sicurezza {-}
|Proprietà|Descrizione|Misura|
|---|------|------|
|Trasmissione sicura|La trasmissione dei dati in ogni funzione deve avvenire in maniera sicura|Il sistema utilizza il protocollo HTTPS|
||||
|Password sicura|La password deve essere lunga almeno 8 caratteri e deve contenere almeno: una lettera maiuscola, una lettera minuscola, un numero|Nel [RF4](#a), [RF7](#a) il sistema non permette di inserire una password non sicura; nel [RF23](#a) il sistema genera una password sicura|
||||
|Password non in chiaro|La password non deve essere salvata in chiaro|Nel [RF4](#a), [RF7](#a), [RF23](#a) sul database è salvato un salted hash della password (funzione bcrypt)|
||||
|Logout|Un utente autenticato deve poter uscire dal proprio account|Funzione di logout [RF5.1](#a) presente|
||||
|Dipendenti dimessi|Un dipendente segnato come dimesso non deve poter autenticarsi nel sistema|Nel [RF5](#a), non è permessa l'autenticazione degli account di dipendenti dimessi|

### RNF3 Portabilità {-}
|Proprietà|Descrizione|Misura|
|---|------|------|
|Compatibilità per ogni RF| Ogni funzione deve essere funzionante sui seguenti sistemi operativi: Windows 7+, MacOS 10.6+, Android 5.0+, iOS 5.0+. Ogni funzione deve essere funzionante sui seguenti browser: Chrome 18+, Chrome Mobile 18+, Safari 5.1+, Safari Mobile 5.0+|Utilizzo di librerie compatibili, testing manuale di ogni funzione per le seguenti coppie (S.O., Browser): (Windows 7, Chrome 18), (MacOS 10.6, Chrome 18), (Android 5.0, Chrome Mobile 18), (iOS 5.0, Chrome Mobile 18), (MacOS 10.6, Safari 5.1), (iOS 5.0, Safari Mobile 5.0)|
||||
|Compatibilità per specifici RF|Le funzioni [RF.Tecnico](#tecnico), [RF.Supervisore](#supervisore), [RF.Amministratore](#amministratore) devono in aggiunta essere funzionanti sui seguenti sistemi operativi: Ubuntu 20.04+. Le specifiche funzioni devono in aggiunta essere funzionanti sui seguenti browser: Firefox 7+, Firefox Mobile 7+|Utilizzo di librerie compatibili, testing manuale delle specifiche funzioni per le seguenti coppie (S.O., Browser): (Ubuntu 20.04, Firefox 7), (Android 5.0, Firefox Mobile 7)|


### RNF4 Prestazioni {-}
<!--
Un software proprietario effettua in sequenza 10 test di prestazione sulla rete intranet di Ardeeno con browser compatibile Chrome su Windows; per ogni test la misurazione parte da quando <succede qualcosa> a quando <succede qualcosa>; il sistema soddisfa il RNF se almeno 7 test hanno durata di al più <x> secondi
-->

|Proprietà|Descrizione|Misura|
|---|----|-----------|
|Prestazioni acquisto|La funzione di acquisto [RF10](#a) deve essere eseguita dal sistema in al più 10 secondi|Un software proprietario effettua in sequenza 10 test di prestazione sulla rete intranet di Ardeeno con browser compatibile Chrome su Windows; per ogni test la misurazione parte da quando il form è inviato a quando appare la scritta "Acquisto concluso" (si utilizza una procedura di pagamento fittizia ed istantanea); il sistema soddisfa il RNF se almeno 7 test hanno durata di al più 10 secondi|
||||
|Prestazioni heatmap|La funzione del cliente [RF12](#a) deve essere eseguita dal sistema in al più 5 secondi|Un software proprietario effettua in sequenza 10 test di prestazione sulla rete intranet di Ardeeno con browser compatibile Chrome su Windows; per ogni test la misurazione parte da quando si richiede al sistema la heatmap dell'impianto a quando la pagina è completamente caricata dal browser (si utilizza un account cliente con un solo impianto modello AQ50A -- 50 sensori, 5 parametri misurati -- con 100 snapshot); il sistema soddisfa il RNF se almeno 7 test hanno durata di al più 5 secondi|
||||
|Prestazioni tecnici|Le funzioni dei tecnici [RF.Tecnico](#tecnico) devono essere eseguite in al più 5 secondi|Un software proprietario effettua in sequenza 10 test di prestazione sulla rete intranet di Ardeeno con browser compatibile Chrome su Windows; ogni test ha 3 sottotest; per il primo sottotest la misurazione parte da quando si richiede al sistema la pagina [RF20](#a) a quando la pagina è completamente caricata dal browser; per il secondo sottotest la misurazione parte da quando si seleziona un intervento dalla lista a quando appare la scritta "Sensore aggiunto"; per il terzo sottotest la misurazione parte da quando si seleziona un intervento dalla lista a quando appare "Intervento concluso"; il sistema soddisfa il RNF se almeno 7 test hanno ogni sottotest con durata di al più 5 secondi (si utilizza un account tecnico con 10 interventi assegnati in corso su 10 impianti)|

\pagebreak
### RNF5 Facilità d'uso {-}

<!--
A 10 dipendenti di Ardeeno sarà fornito: un dispositivo compatibile con Ardeeno WebApp (di cui 4 smartphones Android, 4 pc Windows, 2 tablet Android), l'URL della WebApp (ardeeno.it), un account di Ardeeno WebApp; saranno quindi date le seguenti istruzioni: "<istruzioni>"; la misurazione parte dal momento in cui si forniscono le istruzioni e si conclude quando <succede qualcosa>; il sistema soddisfa il RNF se almeno 7 dipendenti concludono il test in al più <x> minuti

Per 10 dipendenti di Ardeeno sarà organizzato un breve corso di formazione specifica di <x> minuti. Successivamente, verrà fatto un test. Ai 10 dipendenti di Ardeeno sarà fornito: un dispositivo compatibile con Ardeeno WebApp (di cui 4 smartphones Android, 4 pc Windows, 2 tablet Android), l'URL della WebApp (ardeeno.it), un account di Ardeeno WebApp; saranno quindi date le seguenti istruzioni: "<istruzioni>"; la misurazione parte dal momento in cui si forniscono le istruzioni e si conclude quando <succede qualcosa>; il sistema soddisfa il RNF se almeno 7 dipendenti concludono il test in al più <y> minuti  
-->

|Proprietà|Descrizione|Misura|
|---|----|-----------|
|Facilità d'uso utente anonimo|Un utente anonimo deve essere in grado di registrarsi e portare a termine un acquisto ([RF2](#a), [RF4](#a), [RF10](#a)) senza alcun addestramento, imparando in autonomia in meno di 10 minuti|A 10 dipendenti di Ardeeno sarà fornito: un dispositivo compatibile con Ardeeno WebApp (di cui 4 smartphones Android, 4 pc Windows, 2 tablet Android), l'URL della WebApp (ardeeno.it), un account email, un account PayPal; saranno quindi date le seguenti istruzioni: "Registrarsi e concludere un acquisto"; la misurazione parte dal momento in cui si forniscono le istruzioni e si conclude quando, successivamente al pagamento, appare la scritta "Acquisto concluso"; il sistema soddisfa il RNF se almeno 7 dipendenti concludono il test in al più 10 minuti|
||||
|Facilità d'uso supervisore|I supervisori devono imparare ad usare le funzioni [RF17](#a), [RF18](#a), [RF19](#a) con un corso di formazione specifica di al più 15 minuti.|Per 10 supervisori di Ardeeno sarà organizzato un breve corso di formazione specifica di 15 minuti. Successivamente, verrà fatto un test.  Ai 10 supervisori di Ardeeno sarà fornito: un dispositivo compatibile con Ardeeno WebApp (di cui 4 smartphones Android, 4 pc Windows, 2 tablet Android), l'URL della WebApp (ardeeno.it), un account di Ardeeno WebApp; saranno quindi date le seguenti istruzioni: "Visualizzare gli interventi, selezionare il più recente intervento di riparazione richiesto ed assegnarlo ad un tecnico qualsiasi in un giorno qualsiasi"; la misurazione parte dal momento in cui si forniscono le istruzioni e si conclude quando, successivamente all'assegnazione, appare la scritta "Intervento assegnato"; il sistema soddisfa il RNF se almeno 7 supervisori concludono il test in al più 5 minuti.|
||||
|Facilità d'uso tecnico|I tecnici devono imparare ad usare le funzioni [RF20](#a), [RF21](#a), [RF22](#a) con un corso di formazione specifica di al più 15 minuti|Per 10 tecnici di Ardeeno sarà organizzato un breve corso di formazione specifica di 15 minuti. Successivamente, verrà fatto un test.  Ai 10 tecnici di Ardeeno sarà fornito: un dispositivo compatibile con Ardeeno WebApp (di cui 4 smartphones Android, 4 pc Windows, 2 tablet Android), l'URL della WebApp (ardeeno.it), un account di Ardeeno WebApp, un sensore; saranno quindi date le seguenti istruzioni: "Visualizzare gli interventi assegnati, selezionare il più recente intervento di riparazione in corso, aggiungere il sensore fornito, scrivere il resoconto e concludere l'intervento"; la misurazione parte dal momento in cui si forniscono le istruzioni e si conclude quando appare la scritta "Intervento concluso"; il sistema soddisfa il RNF se almeno 7 tecnici concludono il test in al più 5 minuti |
||||
|Codice QR|L'ID sensore deve essere compilabile sia con scrittura da tastiera che inquadrando un codice QR ISO/IEC 18004:2006 con la fotocamera del dispositivo con cui si utilizza il sistema|Funzione presente nel [RF22](#rfa)|

\pagebreak
### RNF6 Scalabilità {-}
<!--
Un software proprietario effettua in contemporanea <x> test di prestazione come da [RNF4.<prop>](#rnf4-prestazioni) (dove nel sistema sono presenti 1000 clienti con ognuno un impianto modello ME100A -- 100 sensori, 10 parametri misurati -- con $12*24*30*12*5=518400$ snapshot); il sistema soddisfa il RNF se almeno <y> test hanno durata di al più <z> secondi
-->

|Proprietà|Descrizione|Misura|
|---|----|-----------|
|Scalabilità acquisto|Il sistema deve mantenere le prestazione descritte in [RNF4.Acquisto](#rnf4-prestazioni) anche con 1000 clienti che contemporaneamente usano [RF10](#a)|Un software proprietario effettua in contemporanea 1000 test di prestazione come da [RNF4.Acquisto](#rnf4-prestazioni) (dove nel sistema sono presenti 1000 clienti con ognuno un impianto modello ME100A -- 100 sensori, 10 parametri misurati -- con $12*24*30*12*5=518400$ snapshot); il sistema soddisfa il RNF se almeno 700 test hanno durata di al più 10 secondi|
||||
|Scalabilità heatmap|Il sistema deve mantenere le prestazione descritte in [RNF4.Heatmap](#rnf4-prestazioni) anche con 1000 clienti che contemporaneamente usano [RF12](#a)|Un software proprietario effettua in contemporanea 1000 test di prestazione come da [RNF4.Heatmap](#rnf4-prestazioni) (dove nel sistema sono presenti 1000 clienti con ognuno un impianto modello ME100A -- 100 sensori, 10 parametri misurati -- con $12*24*30*12*5=518400$ snapshot); il sistema soddisfa il RNF se almeno 700 test hanno durata di al più 5 secondi|
||||
|Scalabilità tecnici|Il sistema deve mantenere le prestazione descritte in [RNF4.Tecnici](#rnf4-prestazioni) anche con 100 tecnici che contemporaneamente usano una qualsiasi delle funzioni [RF.Tecnico](#tecnico)|Un software proprietario effettua in contemporanea 100 test di prestazione come da [RNF4.Tecnici](#rnf4-prestazioni) (dove nel sistema sono presenti 1000 clienti con ognuno un impianto modello ME100A -- 100 sensori, 10 parametri misurati -- con $12*24*30*12*5=518400$ snapshot); il sistema soddisfa il RNF se almeno 700 test hanno ogni sottotest con durata di al più 3 secondi|

# Analisi del Contesto
Nel seguente capitolo vedremo una dettagliata analisi del contesto del sistema da realizzare. Identificheremo gli attori del sistema ed i sistemi esterni (paritari, subordinati e superiori) con cui si interagisce ed evidenzieremo -- con una certa astrazione -- i principali flussi di informazione. Il risultato sarà sintetizzato in un Context Diagram UML.

## Utenti e sistemi esterni

### Utente Anonimo {-}
L'Utente Anonimo è l'attore qualsiasi che accede al sistema. Egli può visualizzare la vetrina, visualizzare le recensioni, registrarsi, recuperare la password, confermare l'indirizzo email ed autenticarsi. A seguito dell'autenticazione [RF5](#a) si specializza in Utente Autenticato.

### Utente Autenticato {-}
L'Utente Autenticato è colui che si è autenticato tramite [RF5](#a) e può in aggiunta fare il logout, visualizzare i dati dell'account e modificarli. Ogni Utente Autenticato è specializzato come Cliente o Dipendente.

### Cliente {-}
Il Cliente è colui che si è registrato nel sistema tramite [RF7](#a) allo scopo di acquistare un impianto. Egli può visualizzare i propri impianti, inserire recensioni, visualizzare le misurazioni, gli interventi e richiedere interventi di riparazione.

### Dipendente {-}
Il Dipendente è colui che è stato registrato nel sistema da un Amministratore tramite [RF23](#a); ogni Dipendente è specializzato come Tecnico o Supervisore.

### Tecnico {-}
Il Tecnico è colui che si occupa degli interventi di installazione, manutenzione, riparazione e dismissione degli impianti. Può visualizzare gli interventi che gli sono stati assegnati e per gli interventi in corso aggiungere/rimuovere sensori dall'impianto e concludere l'intervento con un resoconto.

### Supervisore {-}
Il Supervisore è colui che si occupa di assegnare gli interventi richiesti ad un tecnico in una certa data. Può quindi visualizzare tutti gli interventi e monitorarne lo svolgimento. Alcuni Supervisori sono specializzati in Amministratori.

### Amministratore {-}
L'Amministratore è colui che si occupa di gestire i Dipendenti, segnando i Dipendenti dimessi come tali e registrando tramite [RF23](#a) nuovi Dipendenti (Tecnici, Supervisori o Amministratori). In aggiunta un Amministratore può monitorare l'andamento delle vendite e degli interventi con grafici.

### PayPal {-}
PayPal è il sistema esterno subordinato tramite cui il Cliente effettua il pagamento per concludere l'acquisto di un impianto ([RF10](#a)). L'interazione con PayPal è guidata da ArdeenoWebApp all'invio del form di acquisto in [RF10](#a).

### Gmail {-}
Gmail è il sistema esterno subordinato tramite cui Ardeeno WebApp richiede l'invio delle email utilizzate per [RF6 Conferma indirizzo email](#a), [RF7 Recupero password](#a), [RF9 Modifica dati personali](#a) (nel caso della modifica dell'indirizzo email), [RF25 Modifica dati dipendente](#a) (nel caso della modifica dell'indirizzo email) ed [RF16 Richiesta recensione](#a).

### TrustPilot {-}
TrustPilot è il sistema esterno subordinato tramite cui Ardeeno WebApp richiede e riceve le *service reviews*, le *product reviews* ed i codici per inserire le *product reviews*. TrustPilot è inoltre il sistema tramite cui il Cliente interagisce in maniera guidata in [RF16 Richiesta recensione](#a) per inserire una *product review*.

### OpenStreetMap {-}
OpenStreetMap è il sistema esterno subordinato tramite cui Ardeeno WebApp richiede e riceve mappe geografiche da utilizzare in [RF1 Visualizzazione presentazione](#a) ed [RF12 Visualizzazione misurazioni su heatmap](#a).

### GPS{-}
Il GPS è il sistema esterno subordinato tramite cui Ardeeno WebApp richiede e riceve le coordinate della posizione attuale per [RF22 Aggiunta/rimozione sensori da impianto](#a).

### Ardeeno DataLayer{-}
Ardeeno DataLayer è il sistema esterno paritario con cui Ardeeno WebApp interagisce continuamente per richiedere dati dal DB e inserire dati nel DB. Ardeeno WebApp si interfaccia con questo sistema in tutti i [RF](#a) esclusi: [RF1 Visualizzazione presentazione](#a), [RF5.1 Logout](#a), [RF16 Richiesta recensione](#a) (poiché le recensioni sono memorizzate da TrustPilot).
Il DB del DataLayer è gestito da cloud.mongodb.com .

## Diagramma di contesto

![Diagramma di contesto](.media/contesto.png){width=16cm fig-pos=H}

<!-- Componente s.m. -->
\pagebreak
# Analisi dei Componenti
Nel seguente capitolo analizzeremo una prima architettura a componenti del sistema da realizzare, cercando di minimizzare l'accoppiamento (connessioni inter-componenti) e massimizzare la coesione (connessioni intra-componente). Descriveremo ogni singolo componente nel suo scopo e nelle sue interfacce, seguendo il flusso di utilizzo del sistema. Il risultato sarà sintetizzato in un Diagramma dei Componenti UML.


<!--
Interfacce (interne|relative a (SISTEMA ESTERNO|ATTORE))

Il componente fornisce al (sistema SISTEMA|ATTORE)

Il componente attende dal (sistema SISTEMA|ATTORE) la richiesta per XXX che comprende : PAR1, PAR2, ...

Il componente inoltra al comp. "COMP"

Il componente fornisce al comp. "Gestione invio email" l'email da inviare (che contiene il messaggio XXX)
-->

## Definizione dei componenti

### Pagina presentazione

***Descrizione***
Questo componente si occupa della funzione di visualizzazione della presentazione dell'azienda ([RF1](#a), [RF3](#a)), che comprende: descrizione testuale, mappa con sedi dell'azienda, service reviews. La mappa è reperita da OpenStreetMap.

***Interfacce relative ad OpenStreetMap***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta mappe|Il componente fornisce al sistema OSM una richiesta delle mappe, che comprende: API Token, la tipologia della mappa|
|Richiesta|Mappe|Il componente attende dal sistema OSM le mappe su cui saranno poste le sedi dell'azienda|

***Interfacce relative all'Utente Anonimo***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta pagina|Il componente attende dall'Utente Anonimo la richiesta della pagina di presentazione|
|Fornita|Mostra Pagina|Il componente costruisce e fornisce all'Utente Anonimo la pagina di presentazione|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Service Reviews|Il componente attende le service reviews fornite -- in un certo formato -- dal comp. "Gestione service reviews"|

### Gestione service reviews

***Descrizione***
Questo componente si occupa di reperire le service reviews dal sistema esterno TrustPilot, e fornirle al componente "Pagina Presentazione", come da [RF3](#a).

***Interfacce relative a TrustPilot ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta service reviews|Il componente fornisce al sistema TrustPilot la richiesta delle service reviews, che comprende: API Token, minimo numero di stelle, minima data di invio delle recensioni, numero di service reviews richieste|
|Richiesta|Service Reviews|Il componente attende da TrustPilot la lista di service reviews e il TrustScore. Il componente assume che la richiesta abbia esito positivo|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Service reviews|Il componente fornisce il TrustScore e le service reviews ottenute da TrustPilot e trasformate in un formato standard interno|

### Gestione invio email

***Descrizione***
Questo componente si occupa di interagire col sistema esterno Gmail, a cui richiede di inviare le email fornite dalle altre componenti (per i requisiti funzionali [RF4](#a), [RF6](#a), [RF7](#a), [RF9](#a), [RF10](#a), [RF19](#a) [RF23](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Email|Il componente attende dagli altri componenti una email da inviare, in un formato standard interno. L'email è composta da destinatari, oggetto, corpo e file allegati|

***Interfacce relative a Gmail***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta invio email|Il componente fornisce al sistema Gmail l'API Token e l'email da inviare (secondo il formato dato dalla Gmail API)|

### Conferma indirizzo email

***Descrizione***
Questo componente si occupa dell'intero processo di conferma dell'indirizzo email ([RF6](#a)): generazione del codice di conferma, invio dell'email con il codice di conferma e verifica del codice di conferma fornito dall'Utente Anonimo. Ad ogni inserimento -- effettuato dagli altri componenti -- di una nuova email nella base di dati, l'email è segnata come non confermata e i codici di conferma esistenti eliminati; sotto richiesta viene generato un codice di conferma e viene inserito nella base di dati (associandolo all'ID Utente e specificando il timestamp corrente). L'Utente Anonimo può confermare l'indirizzo email col solo inserimento del codice di conferma (contenuto nel link inviato).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta generazione codice conferma|Il componente attende dagli altri componenti la richiesta -- relativa ad un Utente -- di generare ed inviare un nuovo codice di conferma|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" l'email da inviare (che contiene il codice di conferma generato)|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta inserimento codice|Il componente fornisce al DataLayer una richiesta di inserimento del codice di conferma generato; la richiesta comprende il codice di conferma, l'ID Utente  e il timestamp corrente|
|Fornita|Richiesta verifica codice|Il componente fornisce ad Ardeeno DataLayer un codice di conferma (inserito dall'Utente Anonimo) da verificare|
|Richiesta|Esito Verifica|Il componente ottiene da Ardeeno DataLayer l'esito della verifica del codice di conferma. L'esito è positivo se il codice è esistente e non scaduto; con esito positivo il codice è eliminato e l'email segnata come confermata|

***Interfacce relative all'Utente Anonimo***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta conferma|Il componente attende dall'Utente Anonimo un codice di conferma da verificare|
|Fornita|Esito conferma|Il componente fornisce all'utente anonimo l'esito della conferma|

### Recupero password

***Descrizione***
Questo componente si occupa dell'intero processo di recupero della password ([RF7](#a)): generazione del codice di recupero, invio dell'email con il codice di recupero, verifica del codice di conferma fornito dall'utente anonimo e inserimento della nuova password.


***Interfacce relative all'Utente Anonimo/Interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta generazione codice recupero|Il componente attende dall'Utente Anonimo -- o dalle altre componenti -- una richiesta di generazione del codice di recupero. La richiesta comprende un indirizzo email o l'ID Utente|
|Richiesta|Richiesta recupero|Il componente aspetta dall'Utente Anonimo una richiesta di recupero, che comprende un codice di recupero e una nuova password|
|Fornita|Esito recupero|Il componente fornisce all'Utente Anonimo l'esito della richiesta di recupero. L'esito è positivo se il codice è esistente e non scaduto|

***Interfacce relative ad Ardeeno DataLayer ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta inserimento codice|Il componente fornisce al sistema DataLayer un nuovo codice di recupero -- legato ad una certa email -- da inserire nella base di dati. Il componente assume che l'inserimento non abbia errori (e che l'email sia associata a qualche account)|
|Fornita|Richiesta verifica codice|Il componente fornisce al sistema DataLayer il codice di recupero fornito dall'Utente Anonimo|
|Richiesta|Esito Verifica|Il componente attende l'esito della verifica del codice di recupero|
|Fornita|Richiesta modifica password|Il componente -- se l'esito della verifica è positivo -- fornisce al DataLayer la nuova password fornita dall'Utente Anonimo. Il componente assume che l'inserimento non abbia errori|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" l'email da inviare (che contiene il codice di recupero generato)|

### Registrazione Cliente

***Descrizione***
Questo componente gestisce il processo di registrazione di un cliente nel sistema ([RF4](#a)).

***Interfacce relative all'Utente Anonimo***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta registrazione|Il componente attende dall'Utente Anonimo una richiesta di registrazione, che comprende: email, password, anagrafica|
|Fornita|Esito registrazione|Il componente fornisce all'Utente Anonimo l'esito della registrazione|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta inserimento account|Il componente fornisce al sistema DataLayer una richiesta di inserimento del nuovo account, che comprende tutti quei dati immessi in fase di registrazione|
|Richiesta|Esito inserimento|Il componente attende dal sistema DataLayer l'esito dell'inserimento del nuovo account. L'esito è negativo se l'indirizzo email fornito dall'Utente Anonimo è già associato a qualche account|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" l'email da inviare (che contiene il messaggio di avvenuta registrazione)|

### Login

***Descrizione***
Questo componente si occupa della funzione di login e logout ([RF5](#a), [RF5.1](#a)). In sintesi, si tratta di un componente cuscinetto tra l'Utente Anonimo ed il componente "Autenticazione".

***Interfacce relative all'Utente Anonimo/Autenticato***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta login|Il componente attende dall'Utente Anonimo la richiesta di Login, che comprende indirizzo email e password|
|Fornita|Esito login|Il componente fornisce all'Utente Anonimo l'esito della richiesta di login ottenuta dal comp. "Autenticazione"|
|Richiesta|Richiesta logout|Il componente attende che l'Utente Autenticato fornisca una richiesta di logout|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta login|Il componente fornisce al comp. "Autenticazione" la richiesta di login ricevuta dall'utente anonimo|
|Richiesta|Esito login|Il componente attende dal comp. "Autenticazione" l'esito della richiesta di login|
|Fornita|Richiesta logout|Il componente fornisce al comp. "Autenticazione" una richiesta di logout|

### Autenticazione

***Descrizione***
Questo componente si occupa dell'autenticazione ([RF5](#a), [RF5.1](#a)) e comunica col sistema DataLayer. Inoltre è utilizzato dagli altri componenti per verificare lo stato di autenticazione.

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta login|[Comp. "Login"](#login)|
|Fornita|Esito login|[Comp. "Login"](#login)|
|Fornita|Check auth|Il componente fornisce agli altri componenti lo stato corrente di autenticazione, che comprende -- se il login ha avuto esito positivo -- ID utente ed indirizzo email|
|Fornita|Conferma indirizzo email|Il componente -- se l'email fornita dal comp. "Login" è non confermata -- fornisce al comp. "Conferma indirizzo email" una richiesta di generazione codice di conferma, come descritto nello [UseCase Autenticazione](#usecase-autenticazione)|
|Richiesta|Richiesta logout|Il componente attende dal comp. "Login" una richiesta di logout; lo stato viene riportato a "Non autenticato"|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta verifica credenziali|Il componente fornisce al sistema DataLayer la richiesta di verifica delle credenziali, che comprende indirizzo email e password|
|Richiesta|Esito verifica|Il componente attende dal sistema DataLayer l'esito della verifica delle credenziali. L'esito è positivo se l'indirizzo email è associato a un account esistente e non dimesso, e se la password è corretta|

### Gestione Account

***Descrizione***
Questo componente si occupa della gestione dell'account di un Utente Autenticato ([RF8](#a), [RF9](#a)); ovvero permette a un Utente Autenticato di visualizzare e modificare i propri dati. Interagisce col comp. "Autenticazione". Inoltre, interagisce anche col comp. "Conferma email" nel caso in cui l'Utente modifichi il proprio indirizzo email e col comp. "Gestione invio email" nel caso in cui si modifichino i propri dati.

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|[Comp. "Autenticazione"](#autenticazione)|
|Fornita|Richiesta generazione codice conferma|Il componente fornisce al comp. "Conferma indirizzo email" l'account per cui generare un nuovo codice di conferma|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" un'email da inviare all'Utente, che contiene i dati modificati|

***Interfacce relative all'Utente Autenticato ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Dati Account|Il componente fornisce all'Utente Autenticato i dati del proprio account.|
|Richiesta|Richiesta modifica|Il componente attende dall'Utente Autenticato la richiesta di modifica del proprio account, che comprende come parametri i dati modificati|
|Fornita|Esito modifica|Il componente fornisce all'Utente Autenticato l'esito della modifica dell'account|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta dati|Il componente fornisce al sistema DataLayer l'account di cui ottenere i dati|
|Richiesta|Dati|Il componente attende dal sistema DataLayer i dati dell'account prima fornito|
|Fornita|Richiesta modifica|Il componente fornisce al sistema DataLayer i dati da modificare relativamente a un certo account|
|Richiesta|Esito modifica|Il componente attende dal sistema DataLayer l'esito della modifica|

### Gestione pagamento

***Descrizione***
Questo componente si occupa di gestire i pagamenti tramite PayPal (sottofunzione del [RF10](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta pagamento|Il componente attende dal comp. "Acquisto Impianto" una richiesta di pagamento, che comprende: ID account, ID ordine|
|Fornita|Conferma pagamento|Il componente fornisce al comp. "Acquisto Impianto" l'esito della richiesta di pagamento per un certo ordine; l'esito può essere negativo o positivo|

***Interfacce relative a PayPal***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Purchase unit|Il componente fornisce a PayPal una richiesta di pagamento, che comprende: ID ordine, ID cliente, API token, valuta, costo... e altri parametri. In seguito alla richiesta il Cliente dialogherà direttamente con PayPal|
|Richiesta|Purchase response|Il componente attende da PayPal l'esito del pagamento, che comprende vari parametri|

### Acquisto impianto

***Descrizione***
Questo componente si occupa di gestire il processo di acquisto di un impianto da parte di un Cliente ([RF10](#a), [RF16](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta acquisto impianto|Il componente attende dal comp. "Vetrina" una richiesta di acquisto, che comprende il modello selezionato.|
|Richiesta|Check auth.|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione. L'acquisto può procedere solo se l'Utente è Autenticato ed è un Cliente.|
|Fornita|Richiesta pagamento|[Comp. "Gestione Pagamento"](#gestione-pagamento)|
|Richiesta|Esito pagamento|[Comp. "Gestione Pagamento"](#gestione-pagamento)|
|Fornita|ID ordine|Il componente fornisce l'ID dell'ordine correttamente concluso al comp. "Gestione codice prod.review" (che genera un nuovo codice prod.review) ed al comp. "Gestione installazioni e manutenzioni" (che genera e inserisce un nuovo intervento di installazione)|
|Richiesta|Codice prod.review|Il componente attende dal comp. "Gestione codice prod.review" il codice generato|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" un'email contenente il codice prod.review ed un messaggio di avvenuto acquisto, da inviare al Cliente che ha correttamente concluso l'acquisto|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta inserimento impianto|Il componente fornisce al sistema DataLayer il nuovo impianto da inserire ed assume che non vi siano errori|

***Interfacce relative all'Utente Anonimo/Cliente***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Esito acquisto|Il componente fornisce all'Utente l'esito dell'acquisto|

### Gestione codice prod.reviews

***Descrizione***
Questo componente si occupa di richiedere e ricevere da TrustPilot i codici prod.reviews([RF16](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|ID ordine|Il componente attende l'ID ordine per cui generare il codice prod.review|

***Interfacce relative a TrustPilot***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta codice prod.review|Il componente fornisce a TrustPilot la richiesta di un nuovo codice prod.review, che comprende: ID cliente, ID ordine, ID prodotto, API token|
|Richiesta|Codice prod.review|Il componente attende da TrustPilot il nuovo codice prod.review|

### Gestione installazioni e manutenzioni

***Descrizione***
Questo componente si occupa di inserire automaticamente le richieste di intervento di installazione (all'acquisto di un impianto) e di manutenzione (periodicamente) ([RF10](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|ID ordine|Il componente attende dal comp. "Acquisto impianto" l'ID dell' ordine completato e per cui aggiungere un intervento di installazione|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta impianti attivi|Il componente fornisce al sistema DataLayer la richiesta degli impianti al momento attivi|
|Richiesta|Impianti attivi|Il componente attende dal sistema DataLayer la lista degli impianti al momento attivi|
|Fornita|Richiesta inserimento intervento|Il componente fornisce al sistema DataLayer il nuovo intervento -- manutenzione o installazione -- da inserire, sulla base degli impianti attivi ricevuti o sulla base dell'ID ordine|

### Vetrina

***Descrizione***
Questo componente si occupa di gestire la visualizzazione da parte dell'utente anonimo dei modelli di impianto in vendita e delle prod.reviews; questo componente si occupa inoltre di inoltrare la richiesta di acquisto al comp. "Acquisto impianto". ([RF2](#a))

***Interfacce relative all'Utente Anonimo ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta modelli|Il componente attende che l'utente anonimo richieda i modelli di impianto in vendita|
|Fornita|Modelli|Il componente fornisce all'Utente Anonimo i modelli di impianto in vendita|
|Richiesta|Selezione modello|Il componente attende che l'Utente Anonimo fornisca l'impianto selezionato|
|Fornita|Product reviews|Il componente fornisce all'Utente Anonimo le prod.reviews relative all'impianto selezionato|
|Richiesta|Richiesta acquisto impianto|Il componente attende che l'Utente Anonimo fornisca una richiesta di acquisto riguardo all'impianto selezionato|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta prod.reviews|Il componente fornisce al comp. "Gestione product reviews" l'ID prodotto per il quale richiedere la prod.reviews|
|Richiesta|Prod.reviews|Il componente attende che gli siano fornite le prod.reviews dell'ID prodotto specificato precedentemente|
|Fornita|Richiesta acquisto impianto|[Comp. "Acquisto impianto"](#acquisto-impianto)|

### Gestione product reviews

***Descrizione***
Questo componente si occupa di reperire da TrustPilot le prod.reviews ([RF16](#a)).

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta prod.reviews|[Comp. "Vetrina"](#vetrina)|
|Fornita|Richiesta acquisto impianto|[Comp. "Vetrina"](#vetrina)|

***Interfacce relative a TrustPilot ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta prod.reviews|Il componente fornisce a TrustPilot una richiesta che comprende: API token, ID prodotto, numero di prod.reviews|
|Richiesta|Prod.reviews|Il componente attende che TrustPilot fornisca le prod.reviews|

### Impianti acquistati

***Descrizione***
Questo componente permette ad un Utente Anonimo di visualizzare e selezionare gli impianti acquistati. Interagisce quindi con il sistema Ardeeno DataLayer. ([RF11](#a), [RF11.1](#a))

***Interfacce relative al Cliente***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta impianti|Il componente attende che il Cliente fornisca una richiesta di visualizzazione degli impianti.|
|Fornita|Impianti|Il componente fornisce al Cliente gli impianti da lui acquistati, secondo un certo formato stabilito.|
|Richiesta|Selezione impianto|Il componente attende che il Cliente selezioni un impianto|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione, che comprende anche l'ID Utente e l'indirizzo email. Risponde alle richieste dell'Utente se si è in uno stato autenticato e se l'ID Utente e di tipo Cliente|
|Fornita|ID impianto selezionato|Il componente fornisce internamente l'ID dell'impianto selezionato dal Cliente|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta impianti|Il componente fornisce al sistema DataLayer l'ID Cliente -- ottenuto da Check auth -- di cui raccogliere gli impianti acquistati|
|Richiesta|Impianto|Il componente attende dal sistema DataLayer la lista degli impianti acquistati|

### Misurazioni

***Descrizione***
Questo componente si occupa di reperire dal DataLayer le misurazioni di un certo impianto, inoltrarle ad altri componenti e mostrarle al Cliente/Tecnico in forma tabulare. ([RF13](#a))

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta misurazioni|Il componente attende dagli altri componenti la richiesta di reperire le misurazioni di un certo impianto, che comprende: parametri, periodo temporale|
|Fornita|Misurazioni|Il componente fornisce agli altri componenti le misurazioni raccolte dal DataLayer|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo cliente/tecnico ed ha accesso al determinato ID impianto|
|Richiesta|ID Impianto|Il componente ottiene dal comp. "Impianti acquistati" (o dal comp. "Pagina interventi Tecnico") l'ID dell'impianto di cui raccogliere le misurazioni|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta misurazioni|Il componente fornisce al sistema DataLayer la richiesta di reperire misurazioni, che comprende: ID impianto, ID cliente/tecnico, parametri, periodo temporale|
|Richiesta|Misurazioni|Il componente attende che il sistema DataLayer fornisca le misurazioni richieste|

***Interfacce relative al Cliente/Tecnico***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta tabella|Il componente attende che il Cliente/Tecnico fornisca la richiesta di reperire le misurazioni in forma tabulare|

### Heatmap

***Descrizione***
Questo componente si occupa di costruire la Heatmap e fornirla al Cliente, utilizzando le mappe fornite da OpenStreetMap e le misurazioni fornite dal comp. "Misurazioni". Inoltre, il Cliente interagisce con Il componente fornendo parametri e snapshot di interesse. ([RF12](#a))

***Interfacce relative ad OpenStreetMap ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta mappe|Il componente fornisce al sistema OSM una richiesta delle mappe, che comprende: API Token, la tipologia della mappa|
|Richiesta|Mappe|Le mappe fornite da OpenStreetMap, su cui saranno poste le misurazioni dell'impianto|

Nota: per scelta architetturale entrambi i componenti ["Heatmap"](#heatmap) e ["Pagina presentazione"](#pagina-presentazione) sono dipendenti ad OpenStreetMap.

***Interfacce relative al Cliente***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta heatmap|Il componente attende che il Cliente fornisca una richiesta della heatmap, che comprende: timestamp dello snapshot, parametri|
|Fornita|Heatmap|Il componente costruisce e fornisce al Cliente la Heatmap|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID cliente ha accesso al determinato ID impianto|
|Richiesta|ID impianto|Il componente ottiene dal comp. "Impianti acquistati" l'ID dell'impianto selezionato|

### Pagina interventi Cliente

***Descrizione***
Questo componente fornisce al Cliente gli interventi relativi ad un impianto e permette al Cliente di inserire una richiesta di riparazione.([RF14](#a), [RF15](#a))

***Interfacce relative al Cliente***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta interventi|Il componente attende che il Cliente fornisca una richiesta degli interventi|
|Fornita|Interventi|Il componente fornisce al Cliente gli interventi di un certo impianto|
|Richiesta|Richiesta riparazione|Il componente attende che il Cliente fornisca una richiesta di riparazione, che comprende la motivazione della riparazione|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo Cliente ed ha accesso al determinato ID impianto|
|Richiesta|ID impianto|Il componente ottiene dal comp. "Impianti acquistati" l'ID dell'impianto selezionato|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta interventi|Il componente fornisce al sistema DataLayer la richiesta di reperire gli interventi, che comprende: ID impianto, ID cliente|
|Richiesta|Interventi|Il componente attende dal sistema DataLayer gli interventi relativi all'impianto|
|Fornita|Richiesta riparazione|Il componente fornisce al sistema DataLayer la richiesta di riparazione fornita dal Cliente, che comprende: ID impianto, ID cliente, motivazione riparazione|

Nota: Il controllo sull'esistenza della coppia (ID impianto, ID cliente) è implicito nella richiesta inoltrata al DataLayer; una risposta vuota -- sia dal DataLayer che verso il Cliente -- può essere interpretata come coppia (ID impianto, ID cliente) non esistente. Similmente per richieste al DataLayer nei componenti definiti precedentemente e successivamente.
Diversamente, quando si specifica *Esito* si sottintende un codice di errore esplicito.

### Pagina interventi Tecnico

***Descrizione***
Questo componente si occupa di raccogliere dal DataLayer gli interventi assegnati ad un certo Tecnico e fornirli al Tecnico. ([RF20](#a))

***Interfacce relative al Tecnico ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta interventi|Il componente attende che il Tecnico fornisca la richiesta degli interventi|
|Fornita|Interventi|Il componente fornisce al Tecnico gli interventi raccolti|
|Richiesta|Selezione intervento|Il componente ottiene dal Tecnico l'intervento selezionato|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo ID Tecnico|
|Fornita|ID impianto selezionato|Il componente fornisce al comp. "Misurazioni" l'ID dell'impianto selezionato, ricavato dalla selezione dell'intervento|
|Fornita|ID intervento selezionato|Il componente fornisce al comp. "Operazioni intervento" l'ID dell'intervento selezionato dal Tecnico|

***Interfacce relative ad Ardeeno DataLayer ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta interventi|Il componente fornisce al sistema DataLayer la richiesta di reperire gli interventi assegnati, che comprende l'ID Tecnico|
|Richiesta|Interventi|Il componente attende dal sistema DataLayer gli intervento assegnati al Tecnico|

Nota: per scelta architetturale molti componenti sono dipendenti anche ad Ardeeno DataLayer; sarà il sistema esterno paritario ad assicurarsi di mantenere un certo formato standard interno per richieste/risposte, anche al variare delle tecnologie e servizi utilizzati.
Si osservi che per i rimanenti sistemi esterni (GPS, Gmail, TrustPilot), si utilizzano componenti *cuscinetto* per assicurare il formato standard interno in richieste/risposte.

### Gestione GPS

***Descrizione***
Questo componente interagisce col sistema GPS e fornisce internamente le coordinate GPS reperite.([RNF5](#a))

***Interfacce relative al GPS***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta coordinate|Il componente fornisce al sistema GPS la richiesta delle coordinate, che comprende anche il formato delle coordinate|
|Richiesta|Risposta coordinate|Il componente attende dal sistema GPS le coordinate o un codice di errore|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta coordinate|Il componente attende che qualche altro compoenente fornisca una richiesta delle coordinate|
|Fornita||Il componente fornisce agli altri componenti le coordinate nel formato standard interno, o un codice di errore|

### Operazioni intervento

***Descrizione***
Questo componente gestisce le interazioni tra il Tecnico e l'intervento assegnato selezionato: aggiunta/rimozione sensore, conclusione intervento.([RF21](#a), [RF22](#a))

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|ID intervento selezionato|Il componente ottiene dal comp. "Pagina interventi Tecnico" l'ID dell'intervento in corso selezionato; l'ID dell'intervento in corso comprende l'ID del relativo impianto|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo Tecnico ed ha accesso al determinato ID intervento|
|Fornita|Richiesta coordinate|[Comp. "Gestione GPS"](#gestione-gps)|
|Richiesta|Risposta coordinate|[Comp. "Gestione GPS"](#gestione-gps)|

***Interfacce relative al Tecnico ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta|Il componente attende che il Tecnico fornisca una richiesta di rimozione/aggiunta di un sensore. Per la rimozione la richiesta comprende il solo ID sensore. Per l'aggiunta la richiesta comprende o il solo ID sensore (e le coordinate sono reperite dal GPS) o ID sensore e coordinate|
|Fornita|Esito richiesta|Il componente fornisce al Tecnico l'esito della richiesta di rimozione/aggiunta. Per la rimozione l'esito è negativo se l'ID sensore non è associato all'ID dell'impianto|
|Richiesta|Conclusione con resoconto|Il componente attende che il Tecnico fornisca una richiesta di conclusione dell'intervento, che comprende un resoconto testuale|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta rimozione/aggiunta sensore|Il componente fornisce al DataLayer la richiesta di rimozione/aggiunta sensore, che comprende: ID Tecnico, ID intervento, ID impianto, ID sensore, coordinate|
|Richiesta|Esito richiesta|Il componente attende dal sistema DataLayer l'esito della richiesta di rimozione/aggiunta|
|Fornita|Con|Il componente fornisce al sistema DataLayer la richiesta di conclusione dell'intervento, che comprende: ID Tecnico, ID intervento, ID impianto, resoconto. Il componente assume che la richiesta abbia esito positivo; l'esito negativo è implicito nella visualizzazione dello stato degli interventi nel comp. "Pagina interventi Tecnico"|

### Pagina interventi Supervisore

***Descrizione***
Questo componente si occupa di raccogliere dal DataLayer tutti gli interventi e fornirli al Supervisore. ([RF17](#a))

***Interfacce relative al Supervisore***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta interventi|Il componente attende che il Supervisore fornisca la richiesta degli interventi|
|Fornita|Intervento|Il componente fornisce al Supervisore tutti gli interventi|
|Richiesta|Selezione intervento|Il componente ottiene dal Supervisore l'intervento selezionato|

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato|
|Fornita|ID intervento selezionato|Il componente fornisce al comp. "Assegnazione interventi" l'ID dell'intervento richiesto selezionato dal Supervisore|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta interventi|Il componente fornisce al sistema DataLayer la richiesta degli interventi|
|Richiesta|Interventi|Il componente attende dal sistema DataLayer tutti gli interventi raccolti dalla base di dati|

### Assegnazione interventi

***Descrizione***
Questo componente gestisce l'assegnazione, da parte di un Supervisore, di un intervento a un certo Tecnico.([RF18](#a), [RF19](#a))

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e l'ID Utente è di tipo ID Supervisore|
|Richiesta|ID intervento selezionato|[Comp. "Pagina interventi Supervisore"](#pagina-interventi-supervisore)|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" l'email da inviare al Tecnico, che contiene la data, l'impianto e il tipo di intervento assegnato|

***Interfacce relative al Supervisore***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta tecnici|Il componente attende che il Supervisore fornisca la richiesta dei tecnici disponibili in una certa data|
|Fornita|Tecnici|Il componente fornisce al Supervisore i Tecnici liberi nella certa data|
|Richiesta|Prenotazione|Il componente attende che il Supervisore fornisca una Prenotazione; la prenotazione blocca la selezione del Tecnico in una certa data da parte di altri Supervisori, ma è precedente all'assegnazione nella base di dati|
|Richiesta|Richiesta assegnazione|Il componente attende che il Supervisore fornisca una richiesta di assegnazione, che comprende: ID intervento richiesto, ID tecnico, data|
|Fornita|Esito richiesta|Il componente fornisce al Supervisore l'esito della richiesta di assegnazione. L'esito è negativo se nel tempo di interazione con il DataLayer il Tecnico è diventato non disponibile|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta tecnici|Il componente fornisce al sistema DataLayer la richiesta dei tecnici disponibili in una certa data|
|Richiesta|Tecnici|Il componente attende dal sistema DataLayer i tecnici disponibile nella certa data. Il componente assume che la richiesta abbia esito positivo|
|Fornita|Richiesta assegnazione|Il componente fornisce al sistema DataLayer la richiesta di assegnazione, che comprende: ID intervento, ID Tecnico, data|
|Richiesta|Esito richiesta|Il componente attende dal sistema DataLayer l'esito della richiesta di assegnazione|

### Gestione Dipendenti

***Descrizione***
Questo componente gestisce la registrazione e la modifica degli account di Dipendenti da parte dell'Amministratore. Interagisce con molti altri componenti interni. ([RF23](#a), [RF24](#a), [RF25](#a))

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo ID Amministratore|
|Fornita|Email|Il componente fornisce al comp. "Gestione invio email" un'email di notifica da inviare al Dipendente registrato/modificato contenente i dati dell'account|
|Fornita|Richiesta generazione codice recupero|Il componente fornisce al comp. "Gestione recupero password" una richiesta di generazione di codice di recupero. Questo avviene alla registrazione di un nuovo Dipendente secondo il [RF23](#a)|

***Interfacce relative all'Amministratore ***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta Dipendenti|Il componente attende che l'Amministratore fornisca la richiesta di reperire i Dipendenti|
|Fornita|Dipendenti|Il componente fornisce all'Amministratore i Dipendenti reperiti dal sistema DataLayer|
|Richiesta|Richiesta registrazione/modifica Dipendente|Il componente attende che l'Amministratore fornisca la richiesta di modifica di un Dipendente (che comprende solo quei dati modificati) o di registrazione di un Dipendente (che comprende tutti quei dati discussi nel [RF23](#a))|
|Fornita|Esito richiesta|Il componente fornisce all'Amministratore l'esito della richiesta di registrazione/modifica. L'esito è negativo se un indirizzo email o un CF inserito è già associato a qualche account|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta Dipendenti|Il componente fornisce al sistema DataLayer la richiesta dei Dipendenti|
|Richiesta||Il componente attende dal sistema DataLayer i Dipendenti raccolti dalla base di dati|
|Fornita|Richiesta registrazione/modifica Dipendente|Il componente fornisce al sistema DataLayer la richiesta di registrazione/modifica. A differenza del comp. "Registrazione Cliente", l'email è segnata come confermata, senza necessità della procedura di conferma.|
|Richiesta||Il componente attende dal sistema DataLayer l'esito della richiesta di registrazione/modifica|

### Statistiche

***Descrizione***
Questo componente si occupa di raccogliere dati da Ardeeno DataLayer, aggregarli e fornire grafici interattivi all'Amministratore. ([RF26](#a), [RF27](#a))

***Interfacce interne***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Check auth|Il componente ottiene dal comp. "Autenticazione" lo stato di autenticazione; procede nel compiere le sue funzioni solo se si è in uno stato autenticato e se l'ID Utente è di tipo ID Amministratore|

***Interfacce relative all'Amministratore***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Richiesta|Richiesta grafico|Il componente attende che l'Amministratore fornisca una richiesta del grafico, che comprende: tipo di grafico, periodo da considerare, parametri di interesse|
|Fornita|Grafico|Il componente costruisce e fornisce all'Amministratore il grafico interattivo|

***Interfacce relative ad Ardeeno DataLayer***

|Tipo|Nome|Descrizione|
|---|---|---------------------|
|Fornita|Richiesta dati|Il componente fornisce al sistema DataLayer la richiesta di dati, i cui parametri dipendono dalla richiesta grafico fornita dall'Amministratore|
|Richiesta|Dati|Il componente attende che il sistema DataLayer fornisca i dati. Il componente assume che la richiesta abbia esito positivo|

## Diagramma dei componenti
Alla pagina successiva si trova il diagramma leggibile.
<!--concatenare il pdf!-->

![Anteprima diagramma dei componenti](.media/diagrammacomp.png){width=16cm fig-pos=H}